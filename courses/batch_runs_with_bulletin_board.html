<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Batch runs with bulletin board parallelization &mdash; NEURON  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=6933245a" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/design-tabs.js?v=f930bc37"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HOC Exercises" href="hoc_exercises.html" />
    <link rel="prev" title="State and parameter discontinuities" href="state_and_parameter_discontinuities.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NEURON
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Building:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmake_doc/index.html">CMake Build Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/developer.html">Developer Builds</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../videos/index.html">Training videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="exercises2018.html">NEURON Course Exercises</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro_to_gui.html">Introduction to the GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="interactive_modeling.html">Interactive Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="the_cellbuilder.html">Using the CellBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="neuron_scripting_exercises.html">NEURON scripting exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_morphometric_data.html">Working with Morphometric Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_nmodl_files.html">Using NMODL files</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_modeldb_and_modelview.html">Using ModelDB with NEURON</a></li>
<li class="toctree-l2"><a class="reference internal" href="rxd_exercises.html">Reaction-Diffusion Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="specifying_inhomogeneous_channel_dis.html">Inhomogeneous Channel Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom-initialization.html">Custom Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction_to_the_linear_circuit.html">Introduction to the Linear Circuit Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="state_and_parameter_discontinuities.html">State and parameter discontinuities</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Batch runs with bulletin board parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#physical-system">Physical system</a></li>
<li class="toctree-l3"><a class="reference internal" href="#computational-implementation">Computational implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-model-cell">The model cell</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code-development-strategy">Code development strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initonerun-hoc">initonerun.hoc</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initbatser-hoc">initbatser.hoc</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initbatpar-hoc">initbatpar.hoc</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#things-to-do">Things to do</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hoc_exercises.html">HOC Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="hoc_exercises.html#operators-and-numerical-functions">Operators and numerical functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="hoc_exercises.html#conditionals">Conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="hoc_exercises.html#procedures-and-functions">Procedures and functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="multithread_parallelization.html">Multithreaded parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_to_the_network_builder.html">Introduction to the Network Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="network_ready_cells_from_the_cellb.html">Network ready cells from the CellBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html">Hopfield Brody synchronization (sync) model</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#beyond-the-gui-saving-and-displaying-spikes">Beyond the GUI – Saving and displaying spikes</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#synchronization-measures">Synchronization measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#procedure-interval2-in-ocomm-hoc-sets-cell-periods-randomly">Procedure interval2() in ocomm.hoc sets cell periods randomly</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#rewiring-the-network">Rewiring the network</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#assessing-connectivity">Assessing connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#graphing-connectivity">Graphing connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#animate">Animate</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelization.html">Parallel Computing with MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_nsg_portal.html">Using the Neuroscience Gateway (NSG) portal</a></li>
<li class="toctree-l2"><a class="reference internal" href="numerical-methods-exercises.html">Numerical Methods Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="electrotonic_analysis.html">Electrotonic Analysis with NEURON</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://neuron.yale.edu/phpBB">The NEURON forum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications about NEURON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications-using-neuron.html">Publications using NEURON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NEURON scripting:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripting.html">Running Python and HOC scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">NEURON Python documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hoc/index.html">NEURON HOC documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../otherscripting.html">Other scripting languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Python tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rxd-tutorials/index.html">Python RXD tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coreneuron/index.html">CoreNEURON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NMODLanguage:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nmodl/index.html">NMODLanguage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scm/index.html">NEURON SCM and Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">NEURON Development topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">C/C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Removed Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../removed_features.html">Removed Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changelog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">NEURON 8.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#neuron-8-1">NEURON 8.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#neuron-8-0">NEURON 8.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#feedback-help">Feedback / Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NEURON</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="exercises2018.html">NEURON Course Exercises</a></li>
      <li class="breadcrumb-item active">Batch runs with bulletin board parallelization</li>
<li class="wy-breadcrumbs-aside">
    
    
</li>

      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/courses/batch_runs_with_bulletin_board.rst.txt" rel="nofollow"> View page source</a>
      </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="batch-runs-with-bulletin-board-parallelization">
<span id="id1"></span><h1>Batch runs with bulletin board parallelization<a class="headerlink" href="#batch-runs-with-bulletin-board-parallelization" title="Link to this heading"></a></h1>
<p>Sooner or later most modelers find it necessary to grind out a large number of simulations, varying one or more parameters from one run to the next. The purpose of this exercise is to show you how bulletin board parallelization can speed this up.</p>
<p>This exercise could be done at several levels of complexity. Most challenging and rewarding, but also most time consuming, would be for you to develop all code from scratch. But learning by example also has its virtues, so we provide complete serial and parallel implementations that you can examine and work with.</p>
<p>The following instructions assume that you are using a Mac or PC, with at least NEURON 7.1 under UNIX/Linux, or the latest alpha version of NEURON 7.2 under OS X or MSWin. Also be sure that MPICH 2 is installed if you have UNIX/Linux (OS X already has it, and it comes with NEURON’s installer for MSWin). If you are using a workstation cluster or parallel supercomputer, some details will differ, so ask the system administrator how to get your NEURON source code (.hoc, .ses, .mod, .py files) to where the hosts can use them, how to compile .mod files, and what commands are used to manage simulations.</p>
<section id="physical-system">
<h2>Physical system<a class="headerlink" href="#physical-system" title="Link to this heading"></a></h2>
<p>You have a cell with an excitable dendritic tree. You can inject a steady depolarizing current into the soma and observe membrane potential in the dendrite. Your goal is to find the relationship between the amplitude of the current applied at the soma, and the spike frequency at the distal end of the dendritic tree.</p>
</section>
<section id="computational-implementation">
<h2>Computational implementation<a class="headerlink" href="#computational-implementation" title="Link to this heading"></a></h2>
<section id="the-model-cell">
<h3>The model cell<a class="headerlink" href="#the-model-cell" title="Link to this heading"></a></h3>
<p>The model cell is a ball and stick with these properties:</p>
<p><strong>soma</strong></p>
<blockquote>
<div><p>L 10 um, diam 3.1831 um (area 100 um2)</p>
<p>cm 1 uf/cm2, Ra 100 ohm cm</p>
<p>nseg 1</p>
<p>full hh</p>
</div></blockquote>
<p><strong>dend</strong></p>
<blockquote>
<div><p>L 1000 um, diam 2 um</p>
<p>cm 1 uf/cm2, Ra 100 ohm cm</p>
<p>nseg 25 (appropriate for d_lambda = 0.1 at 100 Hz)</p>
<p>reduced hh (all conductances /=2)</p>
</div></blockquote>
<p>The implementation of this model is in <a class="reference download internal" download="" href="../_downloads/a3d45c6d505c705edb1494a012bc32f6/cell.ho.txt"><code class="xref download docutils literal notranslate"><span class="pre">cell.hoc</span></code></a></p>
</section>
<section id="code-development-strategy">
<h3>Code development strategy<a class="headerlink" href="#code-development-strategy" title="Link to this heading"></a></h3>
<p>Before trying to set up a program that runs multiple simulations, it is useful to have a program that executes a single simulation. This is helpful for exploring the properties of the model and collecting information needed to guide the development of a batch simulation program.</p>
<p>The next step is to create a program that performs serial execution of multiple simulations, i.e. executes them one after another. In addition to generating simulation results, it is useful for this program to report a measure of computational performance. For this example the measure will be the total time required to run all simulations and save results. The simulation results will be needed to verify that the parallel implementation is working properly. The performance measure will help us gauge the success of our efforts, and indicate whether we should look for additional ways to shorten run times.</p>
<p>The final step is to create a parallel implementation of the batch program. This should be tested by comparing its simulation results and performance against those of the serial batch program in order to detect errors or performance deficiencies that should be corrected.</p>
<p>In accordance with this development strategy, we provide the following three programs. For each program there is a brief description, plus one or more examples of usage. There are also links to each program’s source code and code walkthroughs, which may be helpful in completing one of this exercise’s assignments.</p>
<p>Finally, there is a fourth program for plotting results that have been saved to a file, but more about that later.</p>
</section>
<section id="initonerun-hoc">
<h3>initonerun.hoc<a class="headerlink" href="#initonerun-hoc" title="Link to this heading"></a></h3>
<p><strong>Description</strong></p>
<ul class="simple">
<li><p>Executes one simulation with a specified stimulus.</p></li>
<li><p>Displays response and reports spike frequency.</p></li>
</ul>
<p><strong>Usage</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">nrngui</span><span class="w"> </span><span class="n">initbatser</span><span class="p">.</span><span class="n">hoc</span>
</pre></div>
</div>
<p>A new simulation can be launched by entering the command</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">onerun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>at the oc&gt; prompt, where x is a number that specifies the stimulus current amplitude in nA.</p>
<p>Example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">onerun</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Source</strong></p>
<p><a class="reference download internal" download="" href="../_downloads/940cceee847b4e53b0099fcbd3a4254e/initonerun.ho.txt"><code class="xref download docutils literal notranslate"><span class="pre">initonerun.hoc</span></code></a></p>
<p><a class="reference external" href="https://nrn.readthedocs.io/en/latest/courses/batch_runs_bulletin_board_parallelization.html?.py#initonerun-py">code walkthrough</a></p>
</section>
<section id="initbatser-hoc">
<h3>initbatser.hoc<a class="headerlink" href="#initbatser-hoc" title="Link to this heading"></a></h3>
<p><strong>Description</strong></p>
<ul class="simple">
<li><p>Executes a batch of simulations, one at a time, in which stimulus amplitude increases from run to run.</p></li>
<li><p>Then saves results, reports performance, and optionally plots an f-i graph.</p></li>
</ul>
<p><strong>Usage</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">nrngui</span><span class="w"> </span><span class="n">initbatser</span><span class="p">.</span><span class="n">hoc</span>
</pre></div>
</div>
<p><strong>Source</strong></p>
<p><a class="reference download internal" download="" href="../_downloads/c72d043f629383e58f1189f678fc0cff/initbatser.ho.txt"><code class="xref download docutils literal notranslate"><span class="pre">initbatseer.hoc</span></code></a></p>
<p><a class="reference external" href="https://nrn.readthedocs.io/en/latest/courses/batch_runs_bulletin_board_parallelization.html?.py#initbatser-py">code walkthrough</a></p>
</section>
<section id="initbatpar-hoc">
<h3>initbatpar.hoc<a class="headerlink" href="#initbatpar-hoc" title="Link to this heading"></a></h3>
<p><strong>Description</strong></p>
<ul class="simple">
<li><p>Performs the same task as initbatser.hoc, i.e. executes a batch of simulations, but does it serially or in parallel, depending on how the program is launched.</p></li>
<li><p>Parallel execution uses NEURON’s bulletin board.</p></li>
</ul>
<p><strong>Usage</strong></p>
<p>Serial execution:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">initbatpar</span><span class="p">.</span><span class="n">hoc</span>
</pre></div>
</div>
<p>runs simulations one after another on a single processor, i.e. serially. Parallel execution:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">mpiexec</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="n">nrniv</span><span class="w"> </span><span class="o">-</span><span class="n">mpi</span><span class="w"> </span><span class="n">initbatpar</span><span class="p">.</span><span class="n">hoc</span>
</pre></div>
</div>
<p>launches N processes that carry out the simulations. On a multicore PC or Mac, parallel execution with N equal to the number of cores can reduce total run time to about 1/N of the run time required by initbatser.hoc, serial execution of initbatpar.hoc, or parallel execution of initbatpar.hoc with N = 1.</p>
<p><strong>Source</strong></p>
<p><a class="reference download internal" download="" href="../_downloads/e15921d46505da16454be72a7c2b88ee/initbatpar.ho.txt"><code class="xref download docutils literal notranslate"><span class="pre">initbatpar.hoc</span></code></a></p>
<p><a class="reference external" href="https://nrn.readthedocs.io/en/latest/courses/batch_runs_bulletin_board_parallelization.html?.py#initbatpar-py">code walkthrough</a></p>
</section>
</section>
<section id="things-to-do">
<h2>Things to do<a class="headerlink" href="#things-to-do" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Run a few simulations with initonerun.hoc just to see how the cell responds to injected current. You might try to find the smallest and largest stimuli that elicit repetitive dendritic spiking.</p></li>
<li><p>Compare results produced by serial and parallel simulations, to verify that parallelization hasn’t broken anything. For example:</p></li>
</ol>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">nrngui</span><span class="w"> </span><span class="n">initbatser</span><span class="p">.</span><span class="n">hoc</span>
<span class="n">mv</span><span class="w"> </span><span class="n">fi</span><span class="p">.</span><span class="n">dat</span><span class="w"> </span><span class="n">fiser</span><span class="p">.</span><span class="n">dat</span>
<span class="n">nrngui</span><span class="w"> </span><span class="n">initbatpar</span><span class="p">.</span><span class="n">hoc</span>
<span class="n">mv</span><span class="w"> </span><span class="n">fi</span><span class="p">.</span><span class="n">dat</span><span class="w"> </span><span class="n">finompi</span><span class="p">.</span><span class="n">dat</span>
<span class="n">mpd</span><span class="w"> </span><span class="o">&amp;</span>
<span class="n">mpiexec</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">nrniv</span><span class="w"> </span><span class="o">-</span><span class="n">mpi</span><span class="w"> </span><span class="n">initbatpar</span><span class="p">.</span><span class="n">hoc</span>
<span class="n">mv</span><span class="w"> </span><span class="n">fi</span><span class="p">.</span><span class="n">dat</span><span class="w"> </span><span class="n">fimpi4</span><span class="p">.</span><span class="n">dat</span>
<span class="n">cmp</span><span class="w"> </span><span class="n">fiser</span><span class="p">.</span><span class="n">dat</span><span class="w"> </span><span class="n">finompi</span><span class="p">.</span><span class="n">dat</span>
<span class="n">cmp</span><span class="w"> </span><span class="n">fiser</span><span class="p">.</span><span class="n">dat</span><span class="w"> </span><span class="n">fimpi4</span><span class="p">.</span><span class="n">dat</span>
</pre></div>
</div>
<p>Instead of cmp, MSWin users will have to use fc in a “Command prompt” window.</p>
<ol class="arabic" start="3">
<li><p>Evaluate and compare performance of the serial and parallel programs.</p>
<p>Here are results of some tests I ran on a couple of PCs.</p>
</li>
</ol>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">NEURON</span><span class="w"> </span><span class="mf">7.2</span><span class="w"> </span><span class="p">(</span><span class="mi">508</span><span class="o">:</span><span class="mf">9756f</span><span class="mi">32</span><span class="n">df7d0</span><span class="p">)</span><span class="w"> </span><span class="mi">2011</span><span class="mo">-03</span><span class="mi">-16</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">Linux</span>
<span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">quad</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="n">desktop</span><span class="p">.</span>
<span class="n">initbatser</span><span class="w">     </span><span class="mf">10.4</span><span class="w"> </span><span class="n">s</span>
<span class="n">initbatpar</span>
<span class="w">    </span><span class="n">without</span><span class="w"> </span><span class="n">MPI</span><span class="w">  </span><span class="mf">10.2</span>
<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">MPI</span><span class="w">            </span><span class="n">speedup</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">        </span><span class="mf">10.2</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">performance</span><span class="w"> </span><span class="n">baseline</span><span class="p">)</span>
<span class="w">        </span><span class="mi">2</span><span class="w">         </span><span class="mf">5.3</span><span class="w">   </span><span class="mf">1.9</span>
<span class="w">        </span><span class="mi">3</span><span class="w">         </span><span class="mf">3.5</span><span class="w">   </span><span class="mf">2.9</span>
<span class="w">        </span><span class="mi">4</span><span class="w">         </span><span class="mf">2.8</span><span class="w">   </span><span class="mf">3.6</span>

<span class="n">NEURON</span><span class="w"> </span><span class="mf">7.2</span><span class="w"> </span><span class="p">(</span><span class="mi">426</span><span class="o">:</span><span class="mi">7</span><span class="n">b4f020b29e8</span><span class="p">)</span><span class="w"> </span><span class="mi">2010</span><span class="mo">-03</span><span class="mi">-12</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">Linux</span>
<span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="n">laptop</span>
<span class="n">initbatser</span><span class="w">      </span><span class="mf">7.7</span><span class="w"> </span><span class="n">s</span>
<span class="n">initbatpar</span>
<span class="w">    </span><span class="n">without</span><span class="w"> </span><span class="n">MPI</span><span class="w">   </span><span class="mf">7.5</span>
<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">MPI</span><span class="w">            </span><span class="n">speedup</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">         </span><span class="mf">7.7</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">performance</span><span class="w"> </span><span class="n">baseline</span><span class="p">)</span>
<span class="w">        </span><span class="mi">2</span><span class="w">         </span><span class="mf">4.1</span><span class="w">   </span><span class="mf">1.9</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Make a copy of <code class="docutils literal notranslate"><span class="pre">initbatpar.hoc</span></code> and edit it, inserting printf statements that reveal the sequence of execution, i.e. which processor is doing what. These statements should report whatever you think would help you understand program flow. Here are some suggestions for things you might want to report:</p></li>
</ol>
<ul class="simple">
<li><p>the identity of the host process (i.e. the pc.id)</p></li>
<li><p>the name of the proc or func that is being entered or exited</p></li>
<li><p>the value that is being passed or returned</p></li>
<li><p>the index of the simulation that is being run</p></li>
<li><p>anything else that you think might illuminate this dark little corner of computational neuroscience</p></li>
</ul>
<p>Focus on the parts of the program that are involved in the master’s principal function (posting jobs and gathering results), and the workers’ principal function (entering, executing, and exiting <code class="docutils literal notranslate"><span class="pre">fi</span></code>).</p>
<p>After inserting the printf statements, change NRUNS to 3 or 4, then run a serial simulation and see what happens.</p>
<p>Next run parallel simulations with -n 1, 2, 3 or 4 and see what happens. Do the monitor reports make sense?</p>
<ol class="arabic simple" start="5">
<li><p>Examine an f-i curve from data saved to one of the dat files.</p></li>
</ol>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">nrngui</span><span class="w"> </span><span class="n">initplotfi</span><span class="p">.</span><span class="n">hoc</span>
</pre></div>
</div>
<p>then use its file browser to select one of the dat files.</p>
<p>Examine <a class="reference download internal" download="" href="../_downloads/9d02e24e2b357a81f1022b13be718467/initplotfi.ho.txt"><code class="xref download docutils literal notranslate"><span class="pre">initplotfi.hoc</span></code></a> to see how it takes advantage of procs that are built into NEURON’s standard run library (UNIX/Linux users see <code class="docutils literal notranslate"><span class="pre">nrn/share/nrn/lib/hoc/stdlib.hoc</span></code>, MSWin users see <code class="docutils literal notranslate"><span class="pre">c:\nrnxx\lib\hoc\stdlib.hoc</span></code>).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="state_and_parameter_discontinuities.html" class="btn btn-neutral float-left" title="State and parameter discontinuities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hoc_exercises.html" class="btn btn-neutral float-right" title="HOC Exercises" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Duke, Yale and the Blue Brain Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>