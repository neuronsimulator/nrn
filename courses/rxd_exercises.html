<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reaction-Diffusion Exercises &mdash; NEURON  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=6933245a" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/design-tabs.js?v=f930bc37"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Inhomogeneous Channel Distribution" href="specifying_inhomogeneous_channel_dis.html" />
    <link rel="prev" title="Using ModelDB with NEURON" href="using_modeldb_and_modelview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NEURON
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Building:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmake_doc/index.html">CMake Build Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/developer.html">Developer Builds</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../videos/index.html">Training videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="exercises2018.html">NEURON Course Exercises</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro_to_gui.html">Introduction to the GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="interactive_modeling.html">Interactive Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="the_cellbuilder.html">Using the CellBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="neuron_scripting_exercises.html">NEURON scripting exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_morphometric_data.html">Working with Morphometric Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_nmodl_files.html">Using NMODL files</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_modeldb_and_modelview.html">Using ModelDB with NEURON</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Reaction-Diffusion Exercises</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exercise-1">Exercise 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-2">Exercise 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-3">Exercise 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-4">Exercise 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="specifying_inhomogeneous_channel_dis.html">Inhomogeneous Channel Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom-initialization.html">Custom Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction_to_the_linear_circuit.html">Introduction to the Linear Circuit Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="state_and_parameter_discontinuities.html">State and parameter discontinuities</a></li>
<li class="toctree-l2"><a class="reference internal" href="batch_runs_with_bulletin_board.html">Batch runs with bulletin board parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="hoc_exercises.html">HOC Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="hoc_exercises.html#operators-and-numerical-functions">Operators and numerical functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="hoc_exercises.html#conditionals">Conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="hoc_exercises.html#procedures-and-functions">Procedures and functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="multithread_parallelization.html">Multithreaded parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_to_the_network_builder.html">Introduction to the Network Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="network_ready_cells_from_the_cellb.html">Network ready cells from the CellBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html">Hopfield Brody synchronization (sync) model</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#beyond-the-gui-saving-and-displaying-spikes">Beyond the GUI – Saving and displaying spikes</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#synchronization-measures">Synchronization measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#procedure-interval2-in-ocomm-hoc-sets-cell-periods-randomly">Procedure interval2() in ocomm.hoc sets cell periods randomly</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#rewiring-the-network">Rewiring the network</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#assessing-connectivity">Assessing connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#graphing-connectivity">Graphing connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="hopfield_brody_network_in_python.html#animate">Animate</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi_parallelization.html">Parallel Computing with MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_nsg_portal.html">Using the Neuroscience Gateway (NSG) portal</a></li>
<li class="toctree-l2"><a class="reference internal" href="numerical-methods-exercises.html">Numerical Methods Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="electrotonic_analysis.html">Electrotonic Analysis with NEURON</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://neuron.yale.edu/phpBB">The NEURON forum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications about NEURON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications-using-neuron.html">Publications using NEURON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NEURON scripting:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripting.html">Running Python and HOC scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">NEURON Python documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hoc/index.html">NEURON HOC documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../otherscripting.html">Other scripting languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Python tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rxd-tutorials/index.html">Python RXD tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coreneuron/index.html">CoreNEURON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NMODLanguage:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nmodl/index.html">NMODLanguage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scm/index.html">NEURON SCM and Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">NEURON Development topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">C/C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Removed Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../removed_features.html">Removed Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changelog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">NEURON 8.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#neuron-8-1">NEURON 8.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#neuron-8-0">NEURON 8.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html#feedback-help">Feedback / Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NEURON</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="exercises2018.html">NEURON Course Exercises</a></li>
      <li class="breadcrumb-item active">Reaction-Diffusion Exercises</li>
<li class="wy-breadcrumbs-aside">
    
    
</li>

      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/courses/rxd_exercises.rst.txt" rel="nofollow"> View page source</a>
      </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reaction-diffusion-exercises">
<span id="rxd-exercises"></span><h1>Reaction-Diffusion Exercises<a class="headerlink" href="#reaction-diffusion-exercises" title="Link to this heading"></a></h1>
<section id="exercise-1">
<h2>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading"></a></h2>
<p>Consider the signaling molecule IP3, which in Wagner et al 2004 was modeled as having a diffusion coefficient in the cytosol of 0.283 μm<sup>2</sup>/ms. (Our units here are not those usually used by cell biologists, but they are the ones used by NEURON’s reaction-diffusion module as they are reasonable for neuronal electrophysiology.)</p>
<p>Consider a 101 micron long section of dendrite discretized into 101 compartments. Set IP3 at an initial concentration of 1 μM for 0.4 ≤ seg.x ≤ 0.6 and 0 elsewhere. (Be careful about units.) How long does it take the concentration at seg.x = 0.7 to rise to a concentration of 100 nM? What is the peak concentration obtained at this point over all time? What is the limiting value as <span class="math notranslate nohighlight">\(t \to \infty\)</span>?</p>
<p>In 25 °C water, calcium has a diffusion coefficient of <span class="math notranslate nohighlight">\(1.97 \times 10^{-5}\)</span> cm<sup>2</sup>/s according to <a class="reference external" href="http://www.physiologyweb.com/calculators/diffusion_time_calculator.html">physiologyweb</a>. What is this in NEURON’s units of μm<sup>2</sup>/ms? (Note: calcium will have a different effective diffusion constant in a cell than in water due to buffering molecules, etc.) Answer the question about time for a concentration increase at seg.x = 0.7 for calcium in water. Do the same for glucose which has a diffusion coefficient of <span class="math notranslate nohighlight">\(6 \times 10^{-6}\)</span> cm<sup>2</sup>/s according to the same source. How does varying the diffusion coefficient affect the time it takes to raise concentration at a given distance by a given amount?</p>
</section>
<section id="exercise-2">
<h2>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading"></a></h2>
<p>Do the same pulse-diffusion calcium simulation, but on a cylindrical domain with 5 cylindrical spines 3 microns long and 1 micron in diameter. How does the addition of spines affect the diffusion? Why?</p>
<p>How many molecules of calcium would be present in such a spine if it had an average concentration of 100 nM, a biological plausible concentration? (Hint: one cubic micron at 1mM concentration has about 602,200 molecules.) If one molecule stochastically entered or left the spine, what would be the percentage change in the spine’s concentration?</p>
</section>
<section id="exercise-3">
<h2>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading"></a></h2>
<p>Import a CA1 pyramidal cell into NEURON from <a class="reference external" href="https://neuromorpho.org">NeuroMorpho.Org</a>. Declare chemical species <code class="docutils literal notranslate"><span class="pre">X</span></code> to diffuse across the entire cell at D=1 μm<sup>2</sup>/ms with initial concentration of 1 mM in the soma and 0 elsewhere. View the distribution of <code class="docutils literal notranslate"><span class="pre">X</span></code> at 5 and 25 ms on both a ShapePlot and along the apical as a function of distance from the soma. Plot a time series of the concentration of <code class="docutils literal notranslate"><span class="pre">X</span></code> at the center of the soma.</p>
</section>
<section id="exercise-4">
<h2>Exercise 4<a class="headerlink" href="#exercise-4" title="Link to this heading"></a></h2>
<p>Neurons are well-known for their propagating action potentials, but electrical signalling is not their only form of regenerative signaling. <a class="reference external" href="https://doi.org/10.1016/S0896-6273(00)80510-3">Berridge 1998</a> described neuronal calcium dynamics as functioning as a “neuron-within-a-neuron.”</p>
<p>Why is pure diffusion insufficient? What is the expected time for a molecule of IP3 to travel a distance of 50 µm? 100 µm? 1 meter (the approximate length of the longest axon in a human)?</p>
<p>Hint: <span class="math notranslate nohighlight">\(E[t] = x^2 / (2 D)\)</span></p>
<p>The actual dynamics underlying these calcium wave dynamics is complicated, so let’s start with the simplest reaction-diffusion model of a propagating wave:</p>
<p>On a 500 µm long piece of dendrite add a species <code class="docutils literal notranslate"><span class="pre">Y</span></code> with diffusion constant 1 changing by an <a class="reference internal" href="../python/modelspec/programmatic/rxd.html#rxd.Rate" title="rxd.Rate"><code class="xref py py-class docutils literal notranslate"><span class="pre">rxd.Rate</span></code></a> of <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">*</span> <span class="pre">(0</span> <span class="pre">-</span> <span class="pre">y)</span> <span class="pre">*</span> <span class="pre">(alpha</span> <span class="pre">-</span> <span class="pre">y)</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">y)</span></code>. For a first test take <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">0.3</span></code>. Set initial conditions such that <code class="docutils literal notranslate"><span class="pre">Y</span></code> is 1 where seg.x &lt; 0.2 and 0 elsewhere. Plot the concentration of <code class="docutils literal notranslate"><span class="pre">Y</span></code> vs position at several time points to show the development of a traveling wave front.</p>
<p>Run the same simulation with alpha = 0.7. What changes? More generally, how does alpha affect the wave?</p>
<p>Calculate the speed of propagation of the wave front at alpha = 0.3. How can you change scale and the diffusion coefficient to get a wave of the same shape that travels at 50 microns per second? What happens to the shape of the wave front if the diffusion coefficient is increased but the other parameters stay the same?</p>
<p>Things to consider: How do you know if you are using an appropriate value of nseg or dt?</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<p>Berridge, M. J. (1998). Neuronal calcium signaling. Neuron, 21(1), 13-26.</p>
<p>Wagner, J., el al. (2004). A wave of IP 3 production accompanies the fertilization Ca 2+ wave in the egg of the frog, Xenopus laevis: theoretical and experimental support. Cell Calcium, 35(5), 433-447.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="using_modeldb_and_modelview.html" class="btn btn-neutral float-left" title="Using ModelDB with NEURON" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="specifying_inhomogeneous_channel_dis.html" class="btn btn-neutral float-right" title="Inhomogeneous Channel Distribution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Duke, Yale and the Blue Brain Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>