<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1091px" height="1231px" viewBox="-0.5 -0.5 1091 1231" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2023-06-13T07:06:33.389Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.2.8 Chrome/112.0.5615.165 Electron/24.2.0 Safari/537.36&quot; version=&quot;21.2.8&quot; etag=&quot;El6Hz7vRMwiXtwZxItNq&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;_tdOpmX-1IqpOKAl4hbv&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="165" y="0" width="60" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 15px; margin-left: 166px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Initialization</div></div></div></foreignObject><text x="195" y="19" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Initializa...</text></switch></g><path d="M 545 130 L 545 193.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 545 198.88 L 541.5 191.88 L 545 193.63 L 548.5 191.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="155" y="70" width="780" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 778px; height: 1px; padding-top: 100px; margin-left: 156px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Call to finitialize():https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/fadvance.cpp#L968</div></div></div></foreignObject><text x="545" y="104" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Call to finitialize():https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/fadvance.cpp#...</text></switch></g><path d="M 545 260 L 545 323.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 545 328.88 L 541.5 321.88 L 545 323.63 L 548.5 321.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="175" y="200" width="740" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 738px; height: 1px; padding-top: 230px; margin-left: 176px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">nrn_finitialize(int, double): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/fadvance.cpp#L832<br />finitialize passes initial voltage value to finitialize</div></div></div></foreignObject><text x="545" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">nrn_finitialize(int, double): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrno...</text></switch></g><path d="M 545 390 L 545 453.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 545 458.88 L 541.5 451.88 L 545 453.63 L 548.5 451.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="190" y="330" width="710" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 708px; height: 1px; padding-top: 360px; margin-left: 191px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">nrn_fihexec(3);<br />https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrniv/finithnd.cpp#L33<br />Call to finitialize handler kernels with type == 3</div></div></div></foreignObject><text x="545" y="364" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">nrn_fihexec(3);...</text></switch></g><path d="M 545 520 L 545 593.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 545 598.88 L 541.5 591.88 L 545 593.63 L 548.5 591.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="105" y="460" width="880" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 878px; height: 1px; padding-top: 490px; margin-left: 106px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">verify_structure(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/fadvance.cpp#L819<br />Takes care of recalculating circuit related geometry like topology, v vectors and diameters. Also calls nrn_solver_prepare </div></div></div></foreignObject><text x="545" y="494" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">verify_structure(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/fadvance.cpp#L819...</text></switch></g><path d="M 545 660 L 545 743.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 545 748.88 L 541.5 741.88 L 545 743.63 L 548.5 741.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="100" y="600" width="890" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 888px; height: 1px; padding-top: 630px; margin-left: 101px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">if(tree_changed) -&gt; setup_topology(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/cabcode.cpp#L1616<br />Sets up pointer to the parents of the sections</div></div></div></foreignObject><text x="545" y="634" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">if(tree_changed) -&gt; setup_topology(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/cabcode.cpp#L16...</text></switch></g><path d="M 545 810 L 545 883.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 545 888.88 L 541.5 881.88 L 545 883.63 L 548.5 881.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="160" y="750" width="770" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 768px; height: 1px; padding-top: 780px; margin-left: 161px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">if (v_structure_change) -&gt; v_setup_vectors(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/treeset.cpp#L1634<br />Frees and sets up: NrnThreads and memb_list, Calls function that setup auxiliary structs as well to keep track of pointers of C++ objects, Vectors of NrnThread, etc (Too much black magic and details ???), Solve longitudinal diffusion (???) long_difus_solve(), nrn_nonvint_block (???)</div></div></div></foreignObject><text x="545" y="784" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">if (v_structure_change) -&gt; v_setup_vectors(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af...</text></switch></g><path d="M 545 950 L 545 1011.13" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 545 1016.38 L 541.5 1009.38 L 545 1011.13 L 548.5 1009.38 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="115" y="890" width="860" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 858px; height: 1px; padding-top: 920px; margin-left: 116px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">if (diam changed) -&gt; recalc_diam(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/treeset.cpp#L961<br />Reruns v_setup_vectors(), allocates and sets hines matrix data structures in nrn_matrix_node_alloc() and connection_coef(), stim_prepare(), synapse_prepare() and clamp_prepare() set up record/stimulus/synapses</div></div></div></foreignObject><text x="545" y="924" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">if (diam changed) -&gt; recalc_diam(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/treeset.cpp#...</text></switch></g><path d="M 545 1090 L 545 1163.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 545 1168.88 L 541.5 1161.88 L 545 1163.63 L 548.5 1161.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="260" y="1017.5" width="570" height="72.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 568px; height: 1px; padding-top: 1054px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">nrn_solver_prepare(): prepare CVode for execution<br />Sets up fornetcon objects, calls NetCvode::init_global that does a final check that topology, vectors and recalc_diam are set.<br />Call to nrn_ensure_model_data_are_sorted()</div></div></div></foreignObject><text x="545" y="1057" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">nrn_solver_prepare(): prepare CVode for execution...</text></switch></g><rect x="0" y="1170" width="1090" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1088px; height: 1px; padding-top: 1200px; margin-left: 1px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">nrn_ensure_model_data_are_sorted(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/treeset.cpp#L2365</div></div></div></foreignObject><text x="545" y="1204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">nrn_ensure_model_data_are_sorted(): https://github.com/neuronsimulator/nrn/blob/08570476f7129ff4537e261c68d9d894e010af36/src/nrnoc/treeset.cpp#L2365</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>