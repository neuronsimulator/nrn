<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="749px" height="977px" viewBox="-0.5 -0.5 749 977"><defs/><g><rect x="70.4" y="0" width="48" height="24" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 15px; margin-left: 89px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Initialization</div></div></div></foreignObject><text x="118" y="19" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Initializa...</text></switch></g><path d="M 374.4 104 L 374.4 154.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 374.4 159.11 L 371.6 153.51 L 374.4 154.91 L 377.2 153.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="62.4" y="56" width="624" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 778px; height: 1px; padding-top: 100px; margin-left: 79px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Call to <a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/fadvance.cpp#L941" target="_blank">finitialize()</a></div></div></div></foreignObject><text x="468" y="104" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Call to finitialize()</text></switch></g><path d="M 374.4 208 L 374.4 258.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 374.4 263.11 L 371.6 257.51 L 374.4 258.91 L 377.2 257.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="78.4" y="160" width="592" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 738px; height: 1px; padding-top: 230px; margin-left: 99px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/fadvance.cpp#L805" target="_blank">nrn_finitialize(int, double)</a><br />finitialize passes initial voltage value to finitialize</div></div></div></foreignObject><text x="468" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">nrn_finitialize(int, double)...</text></switch></g><path d="M 374.4 312 L 374.4 362.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 374.4 367.11 L 371.6 361.51 L 374.4 362.91 L 377.2 361.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="90.4" y="264" width="568" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 708px; height: 1px; padding-top: 360px; margin-left: 114px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrniv/finithnd.cpp#L33" target="_blank">nrn_fihexec(3);</a><br />Call to finitialize handler kernels with type == 3</div></div></div></foreignObject><text x="468" y="364" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">nrn_fihexec(3);...</text></switch></g><path d="M 374.4 416 L 374.4 474.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 374.4 479.11 L 371.6 473.51 L 374.4 474.91 L 377.2 473.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="22.4" y="368" width="704" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 878px; height: 1px; padding-top: 490px; margin-left: 29px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/fadvance.cpp#L792" target="_blank">verify_structure()</a><br />Takes care of recalculating circuit related geometry like topology, v vectors and diameters. Also calls nrn_solver_prepare </div></div></div></foreignObject><text x="468" y="494" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">verify_structure()...</text></switch></g><path d="M 374.4 528 L 374.4 594.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 374.4 599.11 L 371.6 593.51 L 374.4 594.91 L 377.2 593.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="18.4" y="480" width="712" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 888px; height: 1px; padding-top: 630px; margin-left: 24px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">if(tree_changed) -&gt; <a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/cabcode.cpp#L1598" target="_blank">setup_topology()</a>: Sets up pointer to the parents of the sections</div></div></div></foreignObject><text x="468" y="634" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">if(tree_changed) -&gt; setup_topology(): Sets up pointer to the parents of the sections</text></switch></g><path d="M 374.4 648 L 374.4 706.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 374.4 711.11 L 371.6 705.51 L 374.4 706.91 L 377.2 705.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="66.4" y="600" width="616" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 768px; height: 1px; padding-top: 780px; margin-left: 84px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">if (v_structure_change) -&gt; <a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/treeset.cpp#L1602" target="_blank">v_setup_vectors()</a>:<br />Frees and sets up: NrnThreads and memb_list, Calls function that setup auxiliary structs as well to keep track of pointers of C++ objects, Vectors of NrnThread, etc, Setup longitudinal diffusion with call to <a href="https://github.com/neuronsimulator/nrn/blob/e0290762790622291c4867dee25a7c13e0c2d326/src/nrnoc/ldifus.cpp#L86" target="_blank">long_difus_solve()</a>, Setup CVode with call to <a href="https://github.com/neuronsimulator/nrn/blob/e0290762790622291c4867dee25a7c13e0c2d326/src/nrnoc/nonvintblock.h#L38" target="_blank">nrn_nonvint_block_setup()</a></div></div></div></foreignObject><text x="468" y="784" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">if (v_structure_change) -&gt; v_setup_vectors():...</text></switch></g><path d="M 374.4 760 L 374.4 808.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 374.4 813.11 L 371.6 807.51 L 374.4 808.91 L 377.2 807.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="30.4" y="712" width="688" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 858px; height: 1px; padding-top: 920px; margin-left: 39px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">if (diam changed) -&gt; <a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/treeset.cpp#L929" target="_blank">recalc_diam()</a>: Reruns v_setup_vectors(), allocates and sets hines matrix data structures in nrn_matrix_node_alloc() and connection_coef(), stim_prepare(), synapse_prepare() and clamp_prepare() set up record/stimulus/synapses</div></div></div></foreignObject><text x="468" y="924" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">if (diam changed) -&gt; recalc_diam(): Reruns v_setup_vectors(), allocates and sets hines matrix data structures in nrn_matrix_node_alloc() and co...</text></switch></g><path d="M 374.4 872 L 374.4 922.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 374.4 927.11 L 371.6 921.51 L 374.4 922.91 L 377.2 921.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="146.4" y="814" width="456" height="58" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 568px; height: 1px; padding-top: 1054px; margin-left: 184px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrncvode/cvodestb.cpp#L96" target="_blank">nrn_solver_prepare()</a>: prepare CVode for execution<br />Sets up fornetcon objects, calls <a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrncvode/netcvode.cpp#L1545" target="_blank">NetCvode::init_global</a> that does a final check that topology, vectors and recalc_diam are set.</div></div></div></foreignObject><text x="468" y="1057" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">nrn_solver_prepare(): prepare CVode for execution...</text></switch></g><rect x="0.4" y="928" width="748" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 933px; height: 1px; padding-top: 1190px; margin-left: 1px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/treeset.cpp#L2286" target="_blank">nrn_ensure_model_data_are_sorted()</a></div></div></div></foreignObject><text x="468" y="1194" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">nrn_ensure_model_data_are_sorted()</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>