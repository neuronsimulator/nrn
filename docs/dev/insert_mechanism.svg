<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="913px" height="521px" viewBox="-0.5 -0.5 913 521"><defs/><g><rect x="0" y="0" width="48" height="24" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 15px; margin-left: 1px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Insert mechanism</div></div></div></foreignObject><text x="30" y="19" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Insert mec...</text></switch></g><path d="M 492 184 L 492 242.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 492 247.11 L 489.2 241.51 L 492 242.91 L 494.8 241.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="72" y="136" width="840" height="48" fill="#ffffff" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1048px; height: 1px; padding-top: 200px; margin-left: 91px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/cabcode.cpp#L828" target="_blank">mech_insert1()</a>: insert mechanism to the Section (meaning all the nodes of the sction by calling prop_alloc())</div></div></div></foreignObject><text x="615" y="204" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">mech_insert1(): insert mechanism to the Section (meaning all the nodes of the sction by calling prop_alloc())</text></switch></g><path d="M 232 100 L 232 117.98 L 492.04 117.98 L 492.04 130.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 492.04 135.11 L 489.24 129.51 L 492.04 130.91 L 494.84 129.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="72" y="52" width="320" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 398px; height: 1px; padding-top: 95px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">From python: <a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnpython/nrnpy_nrn.cpp#L1176" target="_blank">NPySecObj_insert</a></div></div></div></foreignObject><text x="290" y="99" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">From python: NPySecObj_insert</text></switch></g><path d="M 748.04 100 L 748.04 117.98 L 492.04 117.98 L 492.04 130.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 492.04 135.11 L 489.24 129.51 L 492.04 130.91 L 494.84 129.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="584" y="52" width="328" height="48" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 408px; height: 1px; padding-top: 95px; margin-left: 731px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">From hoc: <a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrniv/nrnmenu.cpp#L1272" target="_blank">MechanismType::insert</a></div></div></div></foreignObject><text x="935" y="99" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">From hoc: MechanismType::insert</text></switch></g><path d="M 492 296 L 492 354.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 492 359.11 L 489.2 353.51 L 492 354.91 L 494.8 353.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="72" y="248" width="840" height="48" fill="#ffffff" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1048px; height: 1px; padding-top: 340px; margin-left: 91px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/treeset.cpp#L672" target="_blank">prop_alloc()</a><br style="border-color: var(--border-color);" />prop_alloc(): sets `v_structure_change = 1;`<br />It allocates a new `Prop` struct for the mechanism and calls the `&lt;mech_name&gt;_alloc` function defined in the mechanism file.</div></div></div></foreignObject><text x="615" y="344" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prop_alloc()...</text></switch></g><path d="M 492 408 L 492 466.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 492 471.11 L 489.2 465.51 L 492 466.91 L 494.8 465.51 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.8" stroke-miterlimit="10" pointer-events="all"/><rect x="72" y="360" width="840" height="48" fill="#ffffff" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1048px; height: 1px; padding-top: 480px; margin-left: 91px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><a href="https://github.com/neuronsimulator/nrn/blob/a85f6ee0bfdde18e5004218f777fc626f6a2a740/src/nrnoc/section.h#L231" target="_blank">`Prop` constructor</a> calls constructor of `Mechanism::owning_handle`, which inserts a new element into each of the underlying data vectors (`field_data&lt;Tag, FieldImplementation::RuntimeVariable&gt;::m_storage[i]` for all `i`)</div></div></div></foreignObject><text x="615" y="484" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">`Prop` constructor calls constructor of `Mechanism::owning_handle`, which inserts a new element into each of the underlying data vectors (`field_data&lt;Tag, FieldImplementation:...</text></switch></g><rect x="72" y="472" width="840" height="48" fill="#ffffff" stroke="rgb(0, 0, 0)" stroke-width="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.8)"><switch><foreignObject pointer-events="none" width="125%" height="125%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1048px; height: 1px; padding-top: 620px; margin-left: 91px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Look at "Memory allocation of field_data"</div></div></div></foreignObject><text x="615" y="624" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Look at "Memory allocation of field_data"</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>