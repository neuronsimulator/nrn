<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NEURON: /home/runner/work/nrn/nrn/src/nrniv/nonlinz.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NEURON
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('nonlinz_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">nonlinz.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="nonlinz_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;../../nrnconf.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="resource_8h.html">InterViews/resource.h</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nonlinz_8h.html">nonlinz.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nrniv__mf_8h.html">nrniv_mf.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nrnoc2iv_8h.html">nrnoc2iv.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;nrnmpi.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="membfunc_8h.html">membfunc.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;Eigen/Sparse&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">using namespace </span>std::complex_literals;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="nonlinz_8cpp.html#aab22eada665f71f4350df8eb2341e3f6">v_setup_vectors</a>();</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="nonlinz_8cpp.html#a324139c6660ed162e31931d24b772154">nrndae_extra_eqn_count</a>();</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">extern</span> <a class="code" href="struct_symlist.html">Symlist</a>* <a class="code" href="nonlinz_8cpp.html#ae046b60235c6a1c8135201c1dfabd64f">hoc_built_in_symlist</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">extern</span> void (*<a class="code" href="nonlinz_8cpp.html#a19687b91a47188d7593f5dbdbc8121ca">nrnthread_v_transfer_</a>)(<a class="code" href="struct_nrn_thread.html">NrnThread</a>*);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="nonlinz_8cpp.html#a3073f24a4cf34a128bcd68f2188bb4e5">pargap_jacobi_rhs</a>(std::vector&lt;std::complex&lt;double&gt;&gt;&amp;,</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                              <span class="keyword">const</span> std::vector&lt;std::complex&lt;double&gt;&gt;&amp;);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="nonlinz_8cpp.html#a2505e018713fa21359e94db8c2bfe3d1">pargap_jacobi_setup</a>(<span class="keywordtype">int</span> mode);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html">   25</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_non_lin_imp_rep.html">NonLinImpRep</a> {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="class_non_lin_imp_rep.html">NonLinImpRep</a>();</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">void</span> delta(<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// Functions to fill the matrix</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">void</span> didv();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">void</span> dids();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">void</span> dsdv();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">void</span> dsds();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> gapsolve();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// Matrix containing the non linear system to solve.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#ad86328e28d4bb828a44f1c179981d727">   39</a></span>&#160;    Eigen::SparseMatrix&lt;std::complex&lt;double&gt;&gt; m_{};</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// The solver of the matrix using the LU decomposition method.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a11bfca83c19ab8a71e70250a25e6a8b1">   41</a></span>&#160;    Eigen::SparseLU&lt;Eigen::SparseMatrix&lt;std::complex&lt;double&gt;&gt;&gt; lu_{};</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a8bdb06f51bb86a408e5341bb9214c606">   42</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_non_lin_imp_rep.html#a8bdb06f51bb86a408e5341bb9214c606">scnt_</a>;  <span class="comment">// structure_change</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a1f645ec1a7a94fc06b59a659cf9bf5c6">   43</a></span>&#160;    <span class="keywordtype">int</span> n_v_, n_ext_, n_lin_, n_ode_, <a class="code" href="class_non_lin_imp_rep.html#a1f645ec1a7a94fc06b59a659cf9bf5c6">neq_v_</a>, neq_;</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a5064217676c9f83e855ed9883172e3a5">   44</a></span>&#160;    std::vector&lt;neuron::container::data_handle&lt;double&gt;&gt; pv_, <a class="code" href="class_non_lin_imp_rep.html#a5064217676c9f83e855ed9883172e3a5">pvdot_</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a36176333bb6fc9b66b85b55c46233048">   45</a></span>&#160;    std::vector&lt;std::complex&lt;double&gt;&gt; <a class="code" href="class_non_lin_imp_rep.html#a36176333bb6fc9b66b85b55c46233048">v_</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a1cb5c0268915f27d2a197e031286581c">   46</a></span>&#160;    std::vector&lt;double&gt; <a class="code" href="class_non_lin_imp_rep.html#a1cb5c0268915f27d2a197e031286581c">deltavec_</a>;  <span class="comment">// just like cvode.atol*cvode.atolscale for ode&#39;s</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a543a5064d93e54f82aaf3d56f7e3c483">   47</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="class_non_lin_imp_rep.html#a543a5064d93e54f82aaf3d56f7e3c483">delta_</a>;                  <span class="comment">// slightly more efficient and easier for v.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>(<span class="keywordtype">int</span>, <a class="code" href="struct_memb__list.html">Memb_list</a>*, <span class="keywordtype">int</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="ldifus_8cpp.html#a49858a12be388a1a991fee762303d8df">ode</a>(<span class="keywordtype">int</span>, <a class="code" href="struct_memb__list.html">Memb_list</a>*);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a37e971e74d776ae6e42fe61be09089d2">   51</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="class_non_lin_imp_rep.html#a37e971e74d776ae6e42fe61be09089d2">omega_</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a8109efd79a5da6cdbc1fe29b012827e1">   52</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_non_lin_imp_rep.html#a8109efd79a5da6cdbc1fe29b012827e1">iloc_</a>;  <span class="comment">// current injection site of last solve</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#ab2aea3c7285e3e7816acb770c9e5bf85">   53</a></span>&#160;    <span class="keywordtype">float</span>* vsymtol_{};</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a2c185158fa0aea3bc270d9087c716760">   54</a></span>&#160;    <span class="keywordtype">int</span> maxiter_{500};</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;};</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="class_non_lin_imp.html#a6300fccfa88c9ecf5ca144cf3954d2b0">   57</a></span>&#160;<a class="code" href="class_non_lin_imp.html#a6300fccfa88c9ecf5ca144cf3954d2b0">NonLinImp::~NonLinImp</a>() {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keyword">delete</span> rep_;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="class_non_lin_imp.html#a313b42ad2230d3456d1f8d32bcba454b">   61</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_non_lin_imp.html#a313b42ad2230d3456d1f8d32bcba454b">NonLinImp::transfer_amp</a>(<span class="keywordtype">int</span> curloc, <span class="keywordtype">int</span> vloc) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">nrnmpi_numprocs</a> &gt; 1 &amp;&amp; <a class="code" href="nonlinz_8cpp.html#a19687b91a47188d7593f5dbdbc8121ca">nrnthread_v_transfer_</a> &amp;&amp; curloc != rep_-&gt;iloc_) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="stringliteral">&quot;current injection site change not allowed with both gap junctions and nhost &gt; 1&quot;</span>, 0);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (curloc != rep_-&gt;iloc_) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="nonlin_8cpp.html#ab8184ad1f6ab2dd04296c449c4362911">solve</a>(curloc);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> std::abs(rep_-&gt;v_[vloc]);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="class_non_lin_imp.html#ae0275473dc1f24244c761520d2bba106">   71</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_non_lin_imp.html#ae0275473dc1f24244c761520d2bba106">NonLinImp::input_amp</a>(<span class="keywordtype">int</span> curloc) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">nrnmpi_numprocs</a> &gt; 1 &amp;&amp; <a class="code" href="nonlinz_8cpp.html#a19687b91a47188d7593f5dbdbc8121ca">nrnthread_v_transfer_</a>) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(<span class="stringliteral">&quot;not allowed with both gap junctions and nhost&gt;1&quot;</span>, 0);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span> (curloc != rep_-&gt;iloc_) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="nonlin_8cpp.html#ab8184ad1f6ab2dd04296c449c4362911">solve</a>(curloc);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (curloc &lt; 0) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> std::abs(rep_-&gt;v_[curloc]);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="class_non_lin_imp.html#aefd418e97fb6d88a32e86a9d7fed13aa">   83</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_non_lin_imp.html#aefd418e97fb6d88a32e86a9d7fed13aa">NonLinImp::transfer_phase</a>(<span class="keywordtype">int</span> curloc, <span class="keywordtype">int</span> vloc) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">nrnmpi_numprocs</a> &gt; 1 &amp;&amp; <a class="code" href="nonlinz_8cpp.html#a19687b91a47188d7593f5dbdbc8121ca">nrnthread_v_transfer_</a> &amp;&amp; curloc != rep_-&gt;iloc_) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="stringliteral">&quot;current injection site change not allowed with both gap junctions and nhost &gt; 1&quot;</span>, 0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (curloc != rep_-&gt;iloc_) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="nonlin_8cpp.html#ab8184ad1f6ab2dd04296c449c4362911">solve</a>(curloc);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">return</span> std::arg(rep_-&gt;v_[vloc]);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="class_non_lin_imp.html#ad0524c76950ae6c0765e860dcf37df65">   93</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_non_lin_imp.html#ad0524c76950ae6c0765e860dcf37df65">NonLinImp::input_phase</a>(<span class="keywordtype">int</span> curloc) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">nrnmpi_numprocs</a> &gt; 1 &amp;&amp; <a class="code" href="nonlinz_8cpp.html#a19687b91a47188d7593f5dbdbc8121ca">nrnthread_v_transfer_</a>) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(<span class="stringliteral">&quot;not allowed with both gap junctions and nhost&gt;1&quot;</span>, 0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (curloc != rep_-&gt;iloc_) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="nonlin_8cpp.html#ab8184ad1f6ab2dd04296c449c4362911">solve</a>(curloc);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span> (curloc &lt; 0) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> std::arg(rep_-&gt;v_[curloc]);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="class_non_lin_imp.html#a9bfac625ccb4b694d85f01e8bb59fcea">  105</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_non_lin_imp.html#a9bfac625ccb4b694d85f01e8bb59fcea">NonLinImp::ratio_amp</a>(<span class="keywordtype">int</span> clmploc, <span class="keywordtype">int</span> vloc) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">nrnmpi_numprocs</a> &gt; 1 &amp;&amp; <a class="code" href="nonlinz_8cpp.html#a19687b91a47188d7593f5dbdbc8121ca">nrnthread_v_transfer_</a>) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(<span class="stringliteral">&quot;not allowed with both gap junctions and nhost&gt;1&quot;</span>, 0);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (clmploc &lt; 0) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (clmploc != rep_-&gt;iloc_) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="nonlin_8cpp.html#ab8184ad1f6ab2dd04296c449c4362911">solve</a>(clmploc);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span> std::abs(rep_-&gt;v_[vloc] * std::conj(rep_-&gt;v_[clmploc]) / <a class="code" href="namespacecoreneuron_1_1lfputils.html#a9e575875aa6c536c087b63d60f915c31">std::norm</a>(rep_-&gt;v_[clmploc]));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="class_non_lin_imp.html#a9205f0c628541fe394a2f2e747d96d37">  117</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_non_lin_imp.html#a9205f0c628541fe394a2f2e747d96d37">NonLinImp::compute</a>(<span class="keywordtype">double</span> omega, <span class="keywordtype">double</span> <a class="code" href="impedanc_8cpp.html#a4e8d83261d98e69152dd6e7d586490f2">deltafac</a>, <span class="keywordtype">int</span> maxiter) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="nonlinz_8cpp.html#aab22eada665f71f4350df8eb2341e3f6">v_setup_vectors</a>();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="namespacecoreneuron.html#aa297afb53d062b4ffd1917e6451920ee">nrn_rhs</a>(<a class="code" href="nrn__ansi_8h.html#af4cd27306dce6814958b7c50a8a3e248">nrn_ensure_model_data_are_sorted</a>(), <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>[0]);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (rep_ &amp;&amp; rep_-&gt;scnt_ != <a class="code" href="namespacecoreneuron.html#a9672c062385a82b7d8ebf923e9c7e3e3">structure_change_cnt</a>) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keyword">delete</span> rep_;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        rep_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (!rep_) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        rep_ = <span class="keyword">new</span> <a class="code" href="class_non_lin_imp_rep.html">NonLinImpRep</a>();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    rep_-&gt;maxiter_ = maxiter;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">if</span> (rep_-&gt;neq_ == 0) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="nonlinz_8cpp.html#a324139c6660ed162e31931d24b772154">nrndae_extra_eqn_count</a>() &gt; 0) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(<span class="stringliteral">&quot;Impedance calculation with LinearMechanism not implemented&quot;</span>, 0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>-&gt;<a class="code" href="structcoreneuron_1_1_nrn_thread.html#a39219fa45202202ddacdcc8a8148212c">_ecell_memb_list</a>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(<span class="stringliteral">&quot;Impedance calculation with extracellular not implemented&quot;</span>, 0);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    rep_-&gt;omega_ = 1000. * omega;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    rep_-&gt;delta(<a class="code" href="impedanc_8cpp.html#a4e8d83261d98e69152dd6e7d586490f2">deltafac</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    rep_-&gt;m_.setZero();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// fill matrix</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    rep_-&gt;didv();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    rep_-&gt;dsds();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#if 1  // when 0 equivalent to standard method</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    rep_-&gt;dids();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    rep_-&gt;dsdv();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// Now that the matrix is filled we can compress it (mandatory for SparseLU)</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    rep_-&gt;m_.makeCompressed();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// Factorize the matrix so this is ready to solve</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    rep_-&gt;lu_.compute(rep_-&gt;m_);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">switch</span> (rep_-&gt;lu_.info()) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">case</span> Eigen::Success:</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// Everything fine</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">case</span> Eigen::NumericalIssue:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="stringliteral">&quot;Eigen Sparse LU factorization failed with Eigen::NumericalIssue, please check the &quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="stringliteral">&quot;input matrix:&quot;</span>,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            rep_-&gt;lu_.lastErrorMessage().c_str());</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">case</span> Eigen::NoConvergence:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="stringliteral">&quot;Eigen Sparse LU factorization reports Eigen::NonConvergence after calling compute():&quot;</span>,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            rep_-&gt;lu_.lastErrorMessage().c_str());</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">case</span> Eigen::InvalidInput:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="stringliteral">&quot;Eigen Sparse LU factorization failed with Eigen::InvalidInput, the input matrix seems &quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="stringliteral">&quot;invalid:&quot;</span>,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            rep_-&gt;lu_.lastErrorMessage().c_str());</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    rep_-&gt;iloc_ = -2;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="class_non_lin_imp.html#a7c82a03a9b6c3368502abc67534278c7">  182</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_non_lin_imp.html#a7c82a03a9b6c3368502abc67534278c7">NonLinImp::solve</a>(<span class="keywordtype">int</span> curloc) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="struct_nrn_thread.html">NrnThread</a>* _nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (!rep_) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(<span class="stringliteral">&quot;Must call Impedance.compute first&quot;</span>, 0);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (rep_-&gt;iloc_ != curloc) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        rep_-&gt;iloc_ = curloc;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        rep_-&gt;v_ = std::vector&lt;std::complex&lt;double&gt;&gt;(rep_-&gt;neq_);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">if</span> (curloc &gt;= 0) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            rep_-&gt;v_[curloc] = 1.e2 / <a class="code" href="section_8h.html#abcc6d5d56712c1e71924ba5b0a7424e2">NODEAREA</a>(_nt-&gt;<a class="code" href="struct_nrn_thread.html#ad35c5b82ae062b9ec54c45d0ab063fb9">_v_node</a>[curloc]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nonlinz_8cpp.html#a19687b91a47188d7593f5dbdbc8121ca">nrnthread_v_transfer_</a>) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            rval = rep_-&gt;gapsolve();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keyword">auto</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> =</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                Eigen::Map&lt;Eigen::Vector&lt;std::complex&lt;double&gt;, Eigen::Dynamic&gt;&gt;(rep_-&gt;v_.data(),</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                                                                rep_-&gt;v_.size());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = rep_-&gt;lu_.solve(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> rval;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">// too bad it is not easy to reuse the cvode/daspk structures. Most of</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">// mapping is already done there.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a7b911bd0351fc2d5a141dee8d512f01e">  209</a></span>&#160;<a class="code" href="class_non_lin_imp_rep.html#a7b911bd0351fc2d5a141dee8d512f01e">NonLinImpRep::NonLinImpRep</a>() {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="struct_nrn_thread.html">NrnThread</a>* _nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="struct_symbol.html">Symbol</a>* <a class="code" href="occvode_8cpp.html#a87858dcf7e570fd01c1c4a2dc3e676d1">vsym</a> = <a class="code" href="code2_8cpp.html#a76d95f551294ed058dcce32d0b3850b0">hoc_table_lookup</a>(<span class="stringliteral">&quot;v&quot;</span>, <a class="code" href="nonlinz_8cpp.html#ae046b60235c6a1c8135201c1dfabd64f">hoc_built_in_symlist</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="occvode_8cpp.html#a87858dcf7e570fd01c1c4a2dc3e676d1">vsym</a>-&gt;<a class="code" href="struct_symbol.html#adbc7304015dd7d9f8b6d97c3528ec214">extra</a>) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        vsymtol_ = &amp;<a class="code" href="occvode_8cpp.html#a87858dcf7e570fd01c1c4a2dc3e676d1">vsym</a>-&gt;<a class="code" href="struct_symbol.html#adbc7304015dd7d9f8b6d97c3528ec214">extra</a>-&gt;<a class="code" href="struct_hoc_sym_extension.html#ae99f80b72fbc51ae600b8b5861a5356e">tolerance</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// the equation order is the same order as for the fixed step method</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// for current balance. Remaining ode equation order is</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// defined by the memb_list.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// how many equations</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    n_v_ = _nt-&gt;<a class="code" href="struct_nrn_thread.html#a7c22a3198e91f9696b05650266c03bb5">end</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    n_ext_ = 0;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (_nt-&gt;<a class="code" href="struct_nrn_thread.html#ab08e4e11b4ae9ffd80ea6c043799d161">_ecell_memb_list</a>) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        n_ext_ = _nt-&gt;<a class="code" href="struct_nrn_thread.html#ab08e4e11b4ae9ffd80ea6c043799d161">_ecell_memb_list</a>-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a> * <a class="code" href="section__fwd_8hpp.html#ae27b28b2b4822cecf44b1162406a0a2d">nlayer</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    n_lin_ = <a class="code" href="nonlinz_8cpp.html#a324139c6660ed162e31931d24b772154">nrndae_extra_eqn_count</a>();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    n_ode_ = 0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="struct_nrn_thread_memb_list.html">NrnThreadMembList</a>* tml = _nt-&gt;<a class="code" href="struct_nrn_thread.html#a12c49be3278572665cb0ed500c092cc3">tml</a>; tml; tml = tml-&gt;<a class="code" href="struct_nrn_thread_memb_list.html#a7422ba69ea8d926f792eee1bf3c8f810">next</a>) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="struct_memb__list.html">Memb_list</a>* ml = tml-&gt;ml;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = tml-&gt;index;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="membfunc_8h.html#a45f8bde9ed978f835671f8e7d31a3d4c">nrn_ode_count_t</a> <a class="code" href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a> = <a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].ode_count;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> = (*s)(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            n_ode_ += <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> * ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    neq_v_ = n_v_ + n_ext_ + n_lin_;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    neq_ = neq_v_ + n_ode_;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (neq_ == 0) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    m_.resize(neq_, neq_);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    pv_.resize(neq_);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    pvdot_.resize(neq_);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    v_.resize(neq_);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    deltavec_.resize(neq_);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; n_v_; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="comment">// utilize nd-&gt;eqn_index in case of use_sparse13 later</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="struct_node.html">Node</a>* nd = _nt-&gt;<a class="code" href="struct_nrn_thread.html#ad35c5b82ae062b9ec54c45d0ab063fb9">_v_node</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        pv_[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] = nd-&gt;<a class="code" href="struct_node.html#a6ee3d6d998910b57c24c485aa4e9ff92">v_handle</a>();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        pvdot_[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] = nd-&gt;<a class="code" href="struct_node.html#acd172d17c576c241b056c9c30a044962">rhs_handle</a>();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    scnt_ = <a class="code" href="namespacecoreneuron.html#a9672c062385a82b7d8ebf923e9c7e3e3">structure_change_cnt</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a57e0d074077f9b2ffffcdfe116e44722">  258</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_non_lin_imp_rep.html#a57e0d074077f9b2ffffcdfe116e44722">NonLinImpRep::delta</a>(<span class="keywordtype">double</span> <a class="code" href="impedanc_8cpp.html#a4e8d83261d98e69152dd6e7d586490f2">deltafac</a>) {  <span class="comment">// also defines pv_,pvdot_ map for ode</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, nc, <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>, ieq;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="struct_nrn_thread.html">NrnThread</a>* nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; neq_; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        deltavec_[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] = <a class="code" href="impedanc_8cpp.html#a4e8d83261d98e69152dd6e7d586490f2">deltafac</a>;  <span class="comment">// all v&#39;s wasted but no matter.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    ieq = neq_v_;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="struct_nrn_thread_memb_list.html">NrnThreadMembList</a>* tml = nt-&gt;<a class="code" href="struct_nrn_thread.html#a12c49be3278572665cb0ed500c092cc3">tml</a>; tml; tml = tml-&gt;<a class="code" href="struct_nrn_thread_memb_list.html#a7422ba69ea8d926f792eee1bf3c8f810">next</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="struct_memb__list.html">Memb_list</a>* ml = tml-&gt;ml;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = tml-&gt;index;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        nc = ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="membfunc_8h.html#a45f8bde9ed978f835671f8e7d31a3d4c">nrn_ode_count_t</a> <a class="code" href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a> = <a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].<a class="code" href="kschan_8cpp.html#a3d3719d861f76a07579ae9f2ca08c37a">ode_count</a>; <a class="code" href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a> &amp;&amp; (<a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> = <a class="code" href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>)) &gt; 0) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <a class="code" href="membfunc_8h.html#a093b7bc711dec16ab839f3b330282259">nrn_ode_map_t</a> <a class="code" href="kschan_8cpp.html#ac09fe53b05ce31901b8476cee6bf3ec4">ode_map</a> = <a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].ode_map;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a> = 0; <a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a> &lt; nc; ++<a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <a class="code" href="kschan_8cpp.html#ac09fe53b05ce31901b8476cee6bf3ec4">ode_map</a>(ml-&gt;<a class="code" href="struct_memb__list.html#ac25f612ceb86ee50e8e91cf82e37f328">prop</a>[<a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>],</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                        ieq,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                        pv_.data() + ieq,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                        pvdot_.data() + ieq,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                        deltavec_.data() + ieq,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                        <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                ieq += <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    delta_ = (vsymtol_ &amp;&amp; (*vsymtol_ != 0.)) ? *vsymtol_ : 1.;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    delta_ *= <a class="code" href="impedanc_8cpp.html#a4e8d83261d98e69152dd6e7d586490f2">deltafac</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#ab8aa82e87e808bc49de4bda5520c048b">  286</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_non_lin_imp_rep.html#ab8aa82e87e808bc49de4bda5520c048b">NonLinImpRep::didv</a>() {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, <a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>, ip;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="struct_node.html">Node</a>* nd;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="struct_nrn_thread.html">NrnThread</a>* _nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// d2v/dv2 terms</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = _nt-&gt;<a class="code" href="struct_nrn_thread.html#a2196aa5851071e6e2aefd1ff08e79cd3">ncell</a>; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; n_v_; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        nd = _nt-&gt;<a class="code" href="struct_nrn_thread.html#ad35c5b82ae062b9ec54c45d0ab063fb9">_v_node</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        ip = _nt-&gt;<a class="code" href="struct_nrn_thread.html#a988647ef0f1bd28f61b030de9fce87fb">_v_parent</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>]-&gt;<a class="code" href="struct_node.html#a8272596a06a5a4b8fa932a0f7e7652ba">v_node_index</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        m_.coeffRef(ip, <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) += <a class="code" href="section__fwd_8hpp.html#a0316cfe305cf7f4c08083ec6b01422d6">NODEA</a>(nd);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        m_.coeffRef(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ip) += <a class="code" href="section__fwd_8hpp.html#a3869585ebb22ff27e47c12e0bc58495b">NODEB</a>(nd);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        m_.coeffRef(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) -= <a class="code" href="section__fwd_8hpp.html#a3869585ebb22ff27e47c12e0bc58495b">NODEB</a>(nd);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        m_.coeffRef(ip, ip) -= <a class="code" href="section__fwd_8hpp.html#a0316cfe305cf7f4c08083ec6b01422d6">NODEA</a>(nd);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// jwC term</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="struct_memb__list.html">Memb_list</a>* mlc = _nt-&gt;<a class="code" href="struct_nrn_thread.html#a12c49be3278572665cb0ed500c092cc3">tml</a>-&gt;<a class="code" href="struct_nrn_thread_memb_list.html#a781a7b2a37de37688e7b3f0d2ee2bfa5">ml</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="nrngsl_8h.html#ac8a7d09f1236d5375c09b52b83a26add">n</a> = mlc-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; <a class="code" href="nrngsl_8h.html#ac8a7d09f1236d5375c09b52b83a26add">n</a>; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a> = mlc-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>]-&gt;<a class="code" href="struct_node.html#a8272596a06a5a4b8fa932a0f7e7652ba">v_node_index</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        m_.coeffRef(<a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>, <a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>) += .001 * mlc-&gt;<a class="code" href="struct_memb__list.html#ab81001865b26eafcbfae9185fc94b750">data</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, 0) * omega_ * 1<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// di/dv terms</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// because there may be several point processes of the same type</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// at the same location, we have to be careful to neither increment that</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// nd-&gt;v multiple times nor count the rhs multiple times.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// So we can&#39;t take advantage of vectorized point processes.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// To avoid this we do each mechanism item separately.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// We assume there is no interaction between</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// separate locations. Note that interactions such as gap junctions</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// would not be handled in any case without computing a full jacobian.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// i.e. calling nrn_rhs varying every state one at a time (that would</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// give the d2v/dv2 terms as well), but the expense is unwarranted.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="struct_nrn_thread_memb_list.html">NrnThreadMembList</a>* tml = _nt-&gt;<a class="code" href="struct_nrn_thread.html#a12c49be3278572665cb0ed500c092cc3">tml</a>; tml; tml = tml-&gt;<a class="code" href="struct_nrn_thread_memb_list.html#a7422ba69ea8d926f792eee1bf3c8f810">next</a>) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = tml-&gt;index;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> == <a class="code" href="membfunc_8hpp.html#a3aa216f6d9b942391fc15090d23256e5">CAP</a>) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].<a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="struct_memb__list.html">Memb_list</a>* ml = tml-&gt;ml;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a> = 0; <a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a> &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++<a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <a class="code" href="struct_node.html">Node</a>* nd = ml-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a>[<a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordtype">double</span> x2;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="comment">// zero rhs</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="comment">// save v</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <a class="code" href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a>(nd) = 0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordtype">double</span> x1 = <a class="code" href="section__fwd_8hpp.html#a8dc3582efde7730ecd4a67b329e955af">NODEV</a>(nd);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="comment">// v+dv</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            nd-&gt;<a class="code" href="struct_node.html#abc63c6e84b22f08d17d47f2fd4ca3ba1">v</a>() = x1 + delta_;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml, <a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="comment">// save rhs</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="comment">// zero rhs</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="comment">// restore v</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            x2 = <a class="code" href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a>(nd);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <a class="code" href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a>(nd) = 0;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            nd-&gt;<a class="code" href="struct_node.html#abc63c6e84b22f08d17d47f2fd4ca3ba1">v</a>() = x1;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml, <a class="code" href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="comment">// conductance</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="comment">// add to matrix</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            m_.coeffRef(nd-&gt;<a class="code" href="struct_node.html#a8272596a06a5a4b8fa932a0f7e7652ba">v_node_index</a>, nd-&gt;<a class="code" href="struct_node.html#a8272596a06a5a4b8fa932a0f7e7652ba">v_node_index</a>) -= (x2 - <a class="code" href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a>(nd)) / delta_;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a548bd370c46e139b74305700cb6e5ed3">  350</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_non_lin_imp_rep.html#a548bd370c46e139b74305700cb6e5ed3">NonLinImpRep::dids</a>() {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// same strategy as didv but now the innermost loop is over</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// every state but just for that compartment</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// outer loop over ode mechanisms in same order as we created the pv_ map   // so we can eas</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">int</span> ieq, <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, in, is, iis;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="struct_nrn_thread.html">NrnThread</a>* nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    ieq = neq_ - n_ode_;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="struct_nrn_thread_memb_list.html">NrnThreadMembList</a>* tml = nt-&gt;<a class="code" href="struct_nrn_thread.html#a12c49be3278572665cb0ed500c092cc3">tml</a>; tml; tml = tml-&gt;<a class="code" href="struct_nrn_thread_memb_list.html#a7422ba69ea8d926f792eee1bf3c8f810">next</a>) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="struct_memb__list.html">Memb_list</a>* ml = tml-&gt;ml;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = tml-&gt;index;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].<a class="code" href="kschan_8cpp.html#a3d3719d861f76a07579ae9f2ca08c37a">ode_count</a> &amp;&amp; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordtype">int</span> nc = ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <a class="code" href="membfunc_8h.html#a45f8bde9ed978f835671f8e7d31a3d4c">nrn_ode_count_t</a> <a class="code" href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a> = <a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].ode_count;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> = (*s)(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].<a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    <a class="code" href="struct_node.html">Node</a>* nd = ml-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a>[in];</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    <span class="comment">// zero rhs</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <a class="code" href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a>(nd) = 0;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    <span class="comment">// compute rhs</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    <a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml, in);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    <span class="comment">// save rhs</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    v_[in].imag(<a class="code" href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a>(nd));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    <span class="comment">// each state incremented separately and restored</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    <span class="keywordflow">for</span> (iis = 0; iis &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++iis) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        is = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> + iis;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        <span class="comment">// save s</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        v_[is].real(*pv_[is]);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                        <span class="comment">// increment s and zero rhs</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        *pv_[is] += deltavec_[is];</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        <a class="code" href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a>(nd) = 0;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        <a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml, in);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        *pv_[is] = v_[is].real();  <span class="comment">// restore s</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        <span class="keywordtype">double</span> g = (<a class="code" href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a>(nd) - v_[in].imag()) / deltavec_[is];</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                        <span class="keywordflow">if</span> (g != 0.) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                            m_.coeffRef(nd-&gt;<a class="code" href="struct_node.html#a8272596a06a5a4b8fa932a0f7e7652ba">v_node_index</a>, is) = -g;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                        }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    <span class="comment">// don&#39;t know if this is necessary but make sure last</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    <span class="comment">// call with respect to original states</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    <a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml, in);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            ieq += <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> * nc;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a9ab04115b4929b79b0987a668e43b2fa">  398</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_non_lin_imp_rep.html#a9ab04115b4929b79b0987a668e43b2fa">NonLinImpRep::dsdv</a>() {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">int</span> ieq, <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, in, is, iis;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="struct_nrn_thread.html">NrnThread</a>* nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    ieq = neq_ - n_ode_;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="struct_nrn_thread_memb_list.html">NrnThreadMembList</a>* tml = nt-&gt;<a class="code" href="struct_nrn_thread.html#a12c49be3278572665cb0ed500c092cc3">tml</a>; tml; tml = tml-&gt;<a class="code" href="struct_nrn_thread_memb_list.html#a7422ba69ea8d926f792eee1bf3c8f810">next</a>) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <a class="code" href="struct_memb__list.html">Memb_list</a>* ml = tml-&gt;ml;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = tml-&gt;index;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].<a class="code" href="kschan_8cpp.html#a3d3719d861f76a07579ae9f2ca08c37a">ode_count</a> &amp;&amp; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordtype">int</span> nc = ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <a class="code" href="membfunc_8h.html#a45f8bde9ed978f835671f8e7d31a3d4c">nrn_ode_count_t</a> <a class="code" href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a> = <a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].ode_count;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> = (*s)(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].<a class="code" href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a>) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="comment">// zero rhs, save v</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    <a class="code" href="struct_node.html">Node</a>* nd = ml-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a>[in];</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="keywordflow">for</span> (is = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>, iis = 0; iis &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++iis, ++is) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        *pvdot_[is] = 0.;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    v_[in].real(<a class="code" href="section__fwd_8hpp.html#a8dc3582efde7730ecd4a67b329e955af">NODEV</a>(nd));</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                <span class="comment">// increment v only once in case there are multiple</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="comment">// point processes at the same location</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    <a class="code" href="struct_node.html">Node</a>* nd = ml-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a>[in];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = nd-&gt;<a class="code" href="struct_node.html#abc63c6e84b22f08d17d47f2fd4ca3ba1">v</a>();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    <span class="keywordflow">if</span> (v_[in].real() == <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        nd-&gt;<a class="code" href="struct_node.html#abc63c6e84b22f08d17d47f2fd4ca3ba1">v</a>() = <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> + delta_;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="comment">// compute rhs. this is the rhs(v+dv)</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <a class="code" href="ldifus_8cpp.html#a49858a12be388a1a991fee762303d8df">ode</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="comment">// save rhs, restore v, and zero rhs</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    <a class="code" href="struct_node.html">Node</a>* nd = ml-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a>[in];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    <span class="keywordflow">for</span> (is = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>, iis = 0; iis &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++iis, ++is) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                        v_[is].imag(*pvdot_[is]);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        *pvdot_[is] = 0;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    nd-&gt;<a class="code" href="struct_node.html#abc63c6e84b22f08d17d47f2fd4ca3ba1">v</a>() = v_[in].real();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="comment">// compute the rhs(v)</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <a class="code" href="ldifus_8cpp.html#a49858a12be388a1a991fee762303d8df">ode</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="comment">// fill the ds/dv elements</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    <a class="code" href="struct_node.html">Node</a>* nd = ml-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a>[in];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    <span class="keywordflow">for</span> (is = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>, iis = 0; iis &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++iis, ++is) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                        <span class="keywordtype">double</span> ds = (v_[is].imag() - *pvdot_[is]) / delta_;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        <span class="keywordflow">if</span> (ds != 0.) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                            m_.coeffRef(is, nd-&gt;<a class="code" href="struct_node.html#a8272596a06a5a4b8fa932a0f7e7652ba">v_node_index</a>) = -ds;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            ieq += <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> * nc;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#ad71f9084037f0c08e258397c7397f6b3">  456</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_non_lin_imp_rep.html#ad71f9084037f0c08e258397c7397f6b3">NonLinImpRep::dsds</a>() {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">int</span> ieq, <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, in, is, iis, ks, kks;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="struct_nrn_thread.html">NrnThread</a>* nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// jw term</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = neq_v_; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; neq_; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        m_.coeffRef(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) += omega_ * 1<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    ieq = neq_v_;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="struct_nrn_thread_memb_list.html">NrnThreadMembList</a>* tml = nt-&gt;<a class="code" href="struct_nrn_thread.html#a12c49be3278572665cb0ed500c092cc3">tml</a>; tml; tml = tml-&gt;<a class="code" href="struct_nrn_thread_memb_list.html#a7422ba69ea8d926f792eee1bf3c8f810">next</a>) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="struct_memb__list.html">Memb_list</a>* ml = tml-&gt;ml;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = tml-&gt;index;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].<a class="code" href="kschan_8cpp.html#a3d3719d861f76a07579ae9f2ca08c37a">ode_count</a> &amp;&amp; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordtype">int</span> nc = ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="membfunc_8h.html#a45f8bde9ed978f835671f8e7d31a3d4c">nrn_ode_count_t</a> <a class="code" href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a> = <a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>].ode_count;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> = (*s)(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="comment">// zero rhs, save s</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">for</span> (is = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>, iis = 0; iis &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++iis, ++is) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    *pvdot_[is] = 0.;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    v_[is].real(*pv_[is]);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="comment">// compute rhs. this is the rhs(s)</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <a class="code" href="ldifus_8cpp.html#a49858a12be388a1a991fee762303d8df">ode</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="comment">// save rhs</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="keywordflow">for</span> (is = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>, iis = 0; iis &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++iis, ++is) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    v_[is].imag(*pvdot_[is]);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="comment">// iterate over the states</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keywordflow">for</span> (kks = 0; kks &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++kks) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                <span class="comment">// zero rhs, increment s(ks)</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    ks = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> + kks;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                    <span class="keywordflow">for</span> (is = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>, iis = 0; iis &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++iis, ++is) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                        *pvdot_[is] = 0.;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    *pv_[ks] += deltavec_[ks];</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                <a class="code" href="ldifus_8cpp.html#a49858a12be388a1a991fee762303d8df">ode</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="comment">// store element and restore s</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                <span class="comment">// fill the ds/dv elements</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="keywordflow">for</span> (in = 0; in &lt; ml-&gt;<a class="code" href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">nodecount</a>; ++in) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                    <a class="code" href="struct_node.html">Node</a>* nd = ml-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a>[in];</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    ks = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> + kks;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <span class="keywordflow">for</span> (is = ieq + in * <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>, iis = 0; iis &lt; <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a>; ++iis, ++is) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        <span class="keywordtype">double</span> ds = (*pvdot_[is] - v_[is].imag()) / deltavec_[is];</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                        <span class="keywordflow">if</span> (ds != 0.) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                            m_.coeffRef(is, ks) = -ds;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        *pv_[ks] = v_[ks].real();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="comment">// perhaps not necessary but ensures the last computation is with</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="comment">// the base states.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <a class="code" href="ldifus_8cpp.html#a49858a12be388a1a991fee762303d8df">ode</a>(<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>, ml);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            ieq += <a class="code" href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a> * nc;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#ade2b23060784df65087d6a1a43855b6b">  519</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_non_lin_imp_rep.html#ade2b23060784df65087d6a1a43855b6b">NonLinImpRep::current</a>(<span class="keywordtype">int</span> im, <a class="code" href="struct_memb__list.html">Memb_list</a>* ml, <span class="keywordtype">int</span> in) {  <span class="comment">// assume there is in fact a current</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                                             <span class="comment">// method</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// fake a 1 element memb_list</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <a class="code" href="struct_memb__list.html">Memb_list</a> mfake{im};</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    mfake.<a class="code" href="struct_memb__list.html#a852e0e3ee6ca9dd4f1e467710f2fc79d">nodeindices</a> = ml-&gt;<a class="code" href="struct_memb__list.html#a852e0e3ee6ca9dd4f1e467710f2fc79d">nodeindices</a> + in;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    mfake.nodelist = ml-&gt;<a class="code" href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">nodelist</a> + in;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    mfake.set_storage_offset(ml-&gt;<a class="code" href="struct_memb__list.html#adc85ed058419930d59fbef6c88f49557">get_storage_offset</a>());</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    mfake.pdata = ml-&gt;<a class="code" href="struct_memb__list.html#aae68c9fa6be1ca1d477aa6b4dbc9e6c1">pdata</a> + in;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    mfake.prop = ml-&gt;<a class="code" href="struct_memb__list.html#ac25f612ceb86ee50e8e91cf82e37f328">prop</a> ? ml-&gt;<a class="code" href="struct_memb__list.html#ac25f612ceb86ee50e8e91cf82e37f328">prop</a> + in : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    mfake.nodecount = 1;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    mfake._thread = ml-&gt;<a class="code" href="struct_memb__list.html#aecaa9249b834452c28de82fca18fcf7f">_thread</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[im].current(<a class="code" href="nrn__ansi_8h.html#af4cd27306dce6814958b7c50a8a3e248">nrn_ensure_model_data_are_sorted</a>(), <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>, &amp;mfake, im);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#a3a9454aa61ff0236e37990f6e83b5a3d">  533</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_non_lin_imp_rep.html#a3a9454aa61ff0236e37990f6e83b5a3d">NonLinImpRep::ode</a>(<span class="keywordtype">int</span> im, <a class="code" href="struct_memb__list.html">Memb_list</a>* ml) {  <span class="comment">// assume there is in fact an ode method</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a>[im].ode_spec(<a class="code" href="nrn__ansi_8h.html#af4cd27306dce6814958b7c50a8a3e248">nrn_ensure_model_data_are_sorted</a>(), <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>, ml, im);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">// This function compute a solution of a converging system by iteration.</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">// The value returned is the number of iterations to reach a precision of &quot;tol&quot; (1e-9).</span></div>
<div class="line"><a name="l00539"></a><span class="lineno"><a class="line" href="class_non_lin_imp_rep.html#ab4eb16aba47d7f831922a8d02ae99dac">  539</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_non_lin_imp_rep.html#ab4eb16aba47d7f831922a8d02ae99dac">NonLinImpRep::gapsolve</a>() {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// On entry, v_ contains the complex b for A*x = b.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// On return v_ contains complex solution, x.</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// m_ is the factored matrix for the trees without gap junctions</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// Jacobi method (easy for parallel)</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// A = D + R</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// D*x_(k+1) = (b - R*x_(k))</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// D is m_ (and includes the gap junction contribution to the diagonal)</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// R is the off diagonal matrix of the gaps.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// one and only one stimulus</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#if NRNMPI</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">nrnmpi_numprocs</a> &gt; 1 &amp;&amp; nrnmpi_int_sum_reduce(iloc_ &gt;= 0 ? 1 : 0) != 1) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="oc_2nrnmpi_8h.html#a01306122afb94c06c667e20d3a82be28">nrnmpi_myid</a> == 0) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(<span class="stringliteral">&quot;there can be one and only one impedance stimulus&quot;</span>, 0);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="nonlinz_8cpp.html#a2505e018713fa21359e94db8c2bfe3d1">pargap_jacobi_setup</a>(0);  <span class="comment">// 0 means &#39;setup&#39;</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    std::vector&lt;std::complex&lt;double&gt;&gt; x_old(neq_);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    std::vector&lt;std::complex&lt;double&gt;&gt; x(neq_);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    std::vector&lt;std::complex&lt;double&gt;&gt; b(v_);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">// iterate till change in x is small</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordtype">double</span> tol = 1e-9;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">double</span> delta{};</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordtype">int</span> success = 0;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordtype">int</span> iter;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">for</span> (iter = 1; iter &lt;= maxiter_; ++iter) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span> (neq_) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keyword">auto</span> <a class="code" href="nvector__nrnthread_8cpp.html#ad86b6a66875456c3eaf41e2b1c563751">b_</a> = Eigen::Map&lt;Eigen::Vector&lt;std::complex&lt;double&gt;, Eigen::Dynamic&gt;&gt;(b.data(),</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                                                                      b.size());</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keyword">auto</span> <a class="code" href="nvector__nrnthread_8cpp.html#ae8aa68aacddc6a8586d3a59888704c1c">x_</a> = Eigen::Map&lt;Eigen::Vector&lt;std::complex&lt;double&gt;, Eigen::Dynamic&gt;&gt;(x.data(),</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                                                                      x.size());</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <a class="code" href="nvector__nrnthread_8cpp.html#ae8aa68aacddc6a8586d3a59888704c1c">x_</a> = lu_.solve(<a class="code" href="nvector__nrnthread_8cpp.html#ad86b6a66875456c3eaf41e2b1c563751">b_</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment">// if any change in x &gt; tol, then do another iteration.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        success = 1;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        delta = 0.0;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">// Do the substraction of the previous result (x_old) and current result (x).</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="comment">// If all differences are &lt; tol stop the loop, otherwise continue to iterate</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; neq_; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keyword">auto</span> diff = x[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] - x_old[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>];</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordtype">double</span> err = std::abs(diff.real()) + std::abs(diff.imag());</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">if</span> (err &gt; tol) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                success = 0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            delta = std::max(err, delta);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">#if NRNMPI</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">nrnmpi_numprocs</a> &gt; 1) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            success = nrnmpi_int_sum_reduce(success) / <a class="code" href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">nrnmpi_numprocs</a>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (success) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            v_ = x;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">// setup for next iteration</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        x_old = x;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        b = v_;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="nonlinz_8cpp.html#a3073f24a4cf34a128bcd68f2188bb4e5">pargap_jacobi_rhs</a>(b, x_old);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <a class="code" href="nonlinz_8cpp.html#a2505e018713fa21359e94db8c2bfe3d1">pargap_jacobi_setup</a>(1);  <span class="comment">// 1 means &#39;tear down&#39;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">if</span> (!success) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordtype">char</span> <a class="code" href="group___n_m_o_d_l.html#ga47a13a7be8b261aee9f063941328e0c2">buf</a>[256];</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <a class="code" href="namespaceneuron.html#a3678332bd187312e662c73f79238a0a1">Sprintf</a>(<a class="code" href="group___n_m_o_d_l.html#ga47a13a7be8b261aee9f063941328e0c2">buf</a>,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="stringliteral">&quot;Impedance calculation did not converge in %d iterations. Max state change on last &quot;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                <span class="stringliteral">&quot;iteration was %g (Iterations stop at %g)\n&quot;</span>,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                maxiter_,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                delta,</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                tol);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <a class="code" href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">hoc_execerror</a>(<a class="code" href="group___n_m_o_d_l.html#ga47a13a7be8b261aee9f063941328e0c2">buf</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">return</span> iter;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="acoreneuron_2nrnoc_2md1redef_8h_html_ae46bd26d7133dfe98f8cec7c5ac5c7a1"><div class="ttname"><a href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2nrnoc_2md1redef_8h_source.html#l00019">md1redef.h:19</a></div></div>
<div class="ttc" id="amembfunc_8h_html"><div class="ttname"><a href="membfunc_8h.html">membfunc.h</a></div></div>
<div class="ttc" id="acode2_8cpp_html_a76d95f551294ed058dcce32d0b3850b0"><div class="ttname"><a href="code2_8cpp.html#a76d95f551294ed058dcce32d0b3850b0">hoc_table_lookup</a></div><div class="ttdeci">Symbol * hoc_table_lookup(const char *, Symlist *)</div><div class="ttdef"><b>Definition:</b> <a href="oc_2symbol_8cpp_source.html#l00047">symbol.cpp:47</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a543a5064d93e54f82aaf3d56f7e3c483"><div class="ttname"><a href="class_non_lin_imp_rep.html#a543a5064d93e54f82aaf3d56f7e3c483">NonLinImpRep::delta_</a></div><div class="ttdeci">double delta_</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00047">nonlinz.cpp:47</a></div></div>
<div class="ttc" id="astruct_nrn_thread_html_a7c22a3198e91f9696b05650266c03bb5"><div class="ttname"><a href="struct_nrn_thread.html#a7c22a3198e91f9696b05650266c03bb5">NrnThread::end</a></div><div class="ttdeci">int end</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00065">multicore.h:65</a></div></div>
<div class="ttc" id="astruct_symlist_html"><div class="ttname"><a href="struct_symlist.html">Symlist</a></div><div class="ttdef"><b>Definition:</b> <a href="hocdec_8h_source.html#l00075">hocdec.h:75</a></div></div>
<div class="ttc" id="astruct_memb__list_html_aae68c9fa6be1ca1d477aa6b4dbc9e6c1"><div class="ttname"><a href="struct_memb__list.html#aae68c9fa6be1ca1d477aa6b4dbc9e6c1">Memb_list::pdata</a></div><div class="ttdeci">Datum ** pdata</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__ml_8h_source.html#l00075">nrnoc_ml.h:75</a></div></div>
<div class="ttc" id="asection__fwd_8hpp_html_a8dc3582efde7730ecd4a67b329e955af"><div class="ttname"><a href="section__fwd_8hpp.html#a8dc3582efde7730ecd4a67b329e955af">NODEV</a></div><div class="ttdeci">#define NODEV(n)</div><div class="ttdef"><b>Definition:</b> <a href="section__fwd_8hpp_source.html#l00060">section_fwd.hpp:60</a></div></div>
<div class="ttc" id="anonlinz_8cpp_html_a2505e018713fa21359e94db8c2bfe3d1"><div class="ttname"><a href="nonlinz_8cpp.html#a2505e018713fa21359e94db8c2bfe3d1">pargap_jacobi_setup</a></div><div class="ttdeci">void pargap_jacobi_setup(int mode)</div><div class="ttdef"><b>Definition:</b> <a href="nrniv_2partrans_8cpp_source.html#l00794">partrans.cpp:794</a></div></div>
<div class="ttc" id="astruct_node_html_abc63c6e84b22f08d17d47f2fd4ca3ba1"><div class="ttname"><a href="struct_node.html#abc63c6e84b22f08d17d47f2fd4ca3ba1">Node::v</a></div><div class="ttdeci">auto &amp; v()</div><div class="ttdef"><b>Definition:</b> <a href="section_8h_source.html#l00140">section.h:140</a></div></div>
<div class="ttc" id="anrnoc_2cabvars_8h_html_a3bf750212333b1e6667d3ad4fa8e6670"><div class="ttname"><a href="nrnoc_2cabvars_8h.html#a3bf750212333b1e6667d3ad4fa8e6670">memb_func</a></div><div class="ttdeci">std::vector&lt; Memb_func &gt; memb_func</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc_2init_8cpp_source.html#l00144">init.cpp:144</a></div></div>
<div class="ttc" id="aldifus_8cpp_html_a49858a12be388a1a991fee762303d8df"><div class="ttname"><a href="ldifus_8cpp.html#a49858a12be388a1a991fee762303d8df">ode</a></div><div class="ttdeci">static ldifusfunc2_t ode</div><div class="ttdef"><b>Definition:</b> <a href="ldifus_8cpp_source.html#l00043">ldifus.cpp:43</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html"><div class="ttname"><a href="class_non_lin_imp_rep.html">NonLinImpRep</a></div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00025">nonlinz.cpp:25</a></div></div>
<div class="ttc" id="asection__fwd_8hpp_html_a0316cfe305cf7f4c08083ec6b01422d6"><div class="ttname"><a href="section__fwd_8hpp.html#a0316cfe305cf7f4c08083ec6b01422d6">NODEA</a></div><div class="ttdeci">#define NODEA(n)</div><div class="ttdef"><b>Definition:</b> <a href="section__fwd_8hpp_source.html#l00052">section_fwd.hpp:52</a></div></div>
<div class="ttc" id="astruct_hoc_sym_extension_html_ae99f80b72fbc51ae600b8b5861a5356e"><div class="ttname"><a href="struct_hoc_sym_extension.html#ae99f80b72fbc51ae600b8b5861a5356e">HocSymExtension::tolerance</a></div><div class="ttdeci">float tolerance</div><div class="ttdef"><b>Definition:</b> <a href="hocdec_8h_source.html#l00104">hocdec.h:104</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a5935f9973e47c39ce59a576d60d958cd"><div class="ttname"><a href="namespacecoreneuron.html#a5935f9973e47c39ce59a576d60d958cd">coreneuron::nrnmpi_numprocs</a></div><div class="ttdeci">int nrnmpi_numprocs</div><div class="ttdef"><b>Definition:</b> <a href="nrnmpi__def__cinc_8cpp_source.html#l00010">nrnmpi_def_cinc.cpp:10</a></div></div>
<div class="ttc" id="anonlinz_8cpp_html_ae046b60235c6a1c8135201c1dfabd64f"><div class="ttname"><a href="nonlinz_8cpp.html#ae046b60235c6a1c8135201c1dfabd64f">hoc_built_in_symlist</a></div><div class="ttdeci">Symlist * hoc_built_in_symlist</div><div class="ttdef"><b>Definition:</b> <a href="oc_2symbol_8cpp_source.html#l00027">symbol.cpp:27</a></div></div>
<div class="ttc" id="amembfunc_8h_html_a45f8bde9ed978f835671f8e7d31a3d4c"><div class="ttname"><a href="membfunc_8h.html#a45f8bde9ed978f835671f8e7d31a3d4c">nrn_ode_count_t</a></div><div class="ttdeci">int(* nrn_ode_count_t)(int)</div><div class="ttdef"><b>Definition:</b> <a href="membfunc_8h_source.html#l00022">membfunc.h:22</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a8109efd79a5da6cdbc1fe29b012827e1"><div class="ttname"><a href="class_non_lin_imp_rep.html#a8109efd79a5da6cdbc1fe29b012827e1">NonLinImpRep::iloc_</a></div><div class="ttdeci">int iloc_</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00052">nonlinz.cpp:52</a></div></div>
<div class="ttc" id="acoreneuron_2nrnoc_2md1redef_8h_html_a38bf1e5e0427bdeba2b469eea9befc23"><div class="ttname"><a href="coreneuron_2nrnoc_2md1redef_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a></div><div class="ttdeci">#define v</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2nrnoc_2md1redef_8h_source.html#l00011">md1redef.h:11</a></div></div>
<div class="ttc" id="anrniv__mf_8h_html"><div class="ttname"><a href="nrniv__mf_8h.html">nrniv_mf.h</a></div></div>
<div class="ttc" id="anvector__nrnthread_8cpp_html_ad86b6a66875456c3eaf41e2b1c563751"><div class="ttname"><a href="nvector__nrnthread_8cpp.html#ad86b6a66875456c3eaf41e2b1c563751">b_</a></div><div class="ttdeci">static realtype b_</div><div class="ttdef"><b>Definition:</b> <a href="nvector__nrnthread_8cpp_source.html#l00052">nvector_nrnthread.cpp:52</a></div></div>
<div class="ttc" id="astruct_nrn_thread_memb_list_html_a781a7b2a37de37688e7b3f0d2ee2bfa5"><div class="ttname"><a href="struct_nrn_thread_memb_list.html#a781a7b2a37de37688e7b3f0d2ee2bfa5">NrnThreadMembList::ml</a></div><div class="ttdeci">Memb_list * ml</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00035">multicore.h:35</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_html_ae0275473dc1f24244c761520d2bba106"><div class="ttname"><a href="class_non_lin_imp.html#ae0275473dc1f24244c761520d2bba106">NonLinImp::input_amp</a></div><div class="ttdeci">double input_amp(int curloc)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00071">nonlinz.cpp:71</a></div></div>
<div class="ttc" id="astruct_node_html_a6ee3d6d998910b57c24c485aa4e9ff92"><div class="ttname"><a href="struct_node.html#a6ee3d6d998910b57c24c485aa4e9ff92">Node::v_handle</a></div><div class="ttdeci">auto v_handle()</div><div class="ttdef"><b>Definition:</b> <a href="section_8h_source.html#l00152">section.h:152</a></div></div>
<div class="ttc" id="asection_8h_html_abcc6d5d56712c1e71924ba5b0a7424e2"><div class="ttname"><a href="section_8h.html#abcc6d5d56712c1e71924ba5b0a7424e2">NODEAREA</a></div><div class="ttdeci">#define NODEAREA(n)</div><div class="ttdef"><b>Definition:</b> <a href="section_8h_source.html#l00100">section.h:100</a></div></div>
<div class="ttc" id="amembfunc_8h_html_a093b7bc711dec16ab839f3b330282259"><div class="ttname"><a href="membfunc_8h.html#a093b7bc711dec16ab839f3b330282259">nrn_ode_map_t</a></div><div class="ttdeci">void(*)(Prop *, int, neuron::container::data_handle&lt; double &gt; *, neuron::container::data_handle&lt; double &gt; *, double *, int) nrn_ode_map_t</div><div class="ttdef"><b>Definition:</b> <a href="membfunc_8h_source.html#l00038">membfunc.h:38</a></div></div>
<div class="ttc" id="anamespaceneuron_html_a3678332bd187312e662c73f79238a0a1"><div class="ttname"><a href="namespaceneuron.html#a3678332bd187312e662c73f79238a0a1">neuron::Sprintf</a></div><div class="ttdeci">int Sprintf(char(&amp;buf)[N], const char *fmt, Args &amp;&amp;... args)</div><div class="ttdoc">Redirect sprintf to snprintf if the buffer size can be deduced.</div><div class="ttdef"><b>Definition:</b> <a href="wrap__sprintf_8h_source.html#l00012">wrap_sprintf.h:12</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a548bd370c46e139b74305700cb6e5ed3"><div class="ttname"><a href="class_non_lin_imp_rep.html#a548bd370c46e139b74305700cb6e5ed3">NonLinImpRep::dids</a></div><div class="ttdeci">void dids()</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00350">nonlinz.cpp:350</a></div></div>
<div class="ttc" id="astruct_symbol_html_adbc7304015dd7d9f8b6d97c3528ec214"><div class="ttname"><a href="struct_symbol.html#adbc7304015dd7d9f8b6d97c3528ec214">Symbol::extra</a></div><div class="ttdeci">HocSymExtension * extra</div><div class="ttdef"><b>Definition:</b> <a href="hocdec_8h_source.html#l00135">hocdec.h:135</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_ade2b23060784df65087d6a1a43855b6b"><div class="ttname"><a href="class_non_lin_imp_rep.html#ade2b23060784df65087d6a1a43855b6b">NonLinImpRep::current</a></div><div class="ttdeci">void current(int, Memb_list *, int)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00519">nonlinz.cpp:519</a></div></div>
<div class="ttc" id="astruct_node_html_acd172d17c576c241b056c9c30a044962"><div class="ttname"><a href="struct_node.html#acd172d17c576c241b056c9c30a044962">Node::rhs_handle</a></div><div class="ttdeci">auto rhs_handle()</div><div class="ttdef"><b>Definition:</b> <a href="section_8h_source.html#l00161">section.h:161</a></div></div>
<div class="ttc" id="anvector__nrnthread_8cpp_html_ae8aa68aacddc6a8586d3a59888704c1c"><div class="ttname"><a href="nvector__nrnthread_8cpp.html#ae8aa68aacddc6a8586d3a59888704c1c">x_</a></div><div class="ttdeci">static N_Vector x_</div><div class="ttdef"><b>Definition:</b> <a href="nvector__nrnthread_8cpp_source.html#l00046">nvector_nrnthread.cpp:46</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_html_ad0524c76950ae6c0765e860dcf37df65"><div class="ttname"><a href="class_non_lin_imp.html#ad0524c76950ae6c0765e860dcf37df65">NonLinImp::input_phase</a></div><div class="ttdeci">double input_phase(int curloc)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00093">nonlinz.cpp:93</a></div></div>
<div class="ttc" id="astruct_node_html"><div class="ttname"><a href="struct_node.html">Node</a></div><div class="ttdef"><b>Definition:</b> <a href="section_8h_source.html#l00104">section.h:104</a></div></div>
<div class="ttc" id="akschan_8cpp_html_ac09fe53b05ce31901b8476cee6bf3ec4"><div class="ttname"><a href="kschan_8cpp.html#ac09fe53b05ce31901b8476cee6bf3ec4">ode_map</a></div><div class="ttdeci">static void ode_map(Prop *prop, int ieq, neuron::container::data_handle&lt; double &gt; *pv, neuron::container::data_handle&lt; double &gt; *pvdot, double *atol, int type)</div><div class="ttdef"><b>Definition:</b> <a href="kschan_8cpp_source.html#l00097">kschan.cpp:97</a></div></div>
<div class="ttc" id="anamespacecoreneuron_1_1lfputils_html_a9e575875aa6c536c087b63d60f915c31"><div class="ttname"><a href="namespacecoreneuron_1_1lfputils.html#a9e575875aa6c536c087b63d60f915c31">coreneuron::lfputils::norm</a></div><div class="ttdeci">double norm(const Point3D &amp;p1)</div><div class="ttdef"><b>Definition:</b> <a href="lfp_8hpp_source.html#l00022">lfp.hpp:22</a></div></div>
<div class="ttc" id="astructcoreneuron_1_1_nrn_thread_html_a39219fa45202202ddacdcc8a8148212c"><div class="ttname"><a href="structcoreneuron_1_1_nrn_thread.html#a39219fa45202202ddacdcc8a8148212c">coreneuron::NrnThread::_ecell_memb_list</a></div><div class="ttdeci">Memb_list * _ecell_memb_list</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8hpp_source.html#l00129">multicore.hpp:129</a></div></div>
<div class="ttc" id="aoc_2nrnmpi_8h_html_a01306122afb94c06c667e20d3a82be28"><div class="ttname"><a href="oc_2nrnmpi_8h.html#a01306122afb94c06c667e20d3a82be28">nrnmpi_myid</a></div><div class="ttdeci">int nrnmpi_myid</div><div class="ttdef"><b>Definition:</b> <a href="nrnmpi__def__cinc_8cpp_source.html#l00011">nrnmpi_def_cinc.cpp:11</a></div></div>
<div class="ttc" id="agroup__hoc__functions_html_ga1f1290c5c93eb6c5c39f4352be583cfa"><div class="ttname"><a href="group__hoc__functions.html#ga1f1290c5c93eb6c5c39f4352be583cfa">coreneuron::hoc_execerror</a></div><div class="ttdeci">void hoc_execerror(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__aux_8cpp_source.html#l00039">nrnoc_aux.cpp:39</a></div></div>
<div class="ttc" id="acoreneuron_2network_2tqueue_8hpp_html_a2502bdb1cc7403561c336de5d73c5f85"><div class="ttname"><a href="coreneuron_2network_2tqueue_8hpp.html#a2502bdb1cc7403561c336de5d73c5f85">cnt</a></div><div class="ttdeci">#define cnt</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2network_2tqueue_8hpp_source.html#l00044">tqueue.hpp:44</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_html_a9205f0c628541fe394a2f2e747d96d37"><div class="ttname"><a href="class_non_lin_imp.html#a9205f0c628541fe394a2f2e747d96d37">NonLinImp::compute</a></div><div class="ttdeci">void compute(double omega, double deltafac, int maxiter)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00117">nonlinz.cpp:117</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a57e0d074077f9b2ffffcdfe116e44722"><div class="ttname"><a href="class_non_lin_imp_rep.html#a57e0d074077f9b2ffffcdfe116e44722">NonLinImpRep::delta</a></div><div class="ttdeci">void delta(double)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00258">nonlinz.cpp:258</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_aa297afb53d062b4ffd1917e6451920ee"><div class="ttname"><a href="namespacecoreneuron.html#aa297afb53d062b4ffd1917e6451920ee">coreneuron::nrn_rhs</a></div><div class="ttdeci">static void nrn_rhs(NrnThread *_nt)</div><div class="ttdef"><b>Definition:</b> <a href="treeset__core_8cpp_source.html#l00023">treeset_core.cpp:23</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a37e971e74d776ae6e42fe61be09089d2"><div class="ttname"><a href="class_non_lin_imp_rep.html#a37e971e74d776ae6e42fe61be09089d2">NonLinImpRep::omega_</a></div><div class="ttdeci">double omega_</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00051">nonlinz.cpp:51</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_html_a6300fccfa88c9ecf5ca144cf3954d2b0"><div class="ttname"><a href="class_non_lin_imp.html#a6300fccfa88c9ecf5ca144cf3954d2b0">NonLinImp::~NonLinImp</a></div><div class="ttdeci">~NonLinImp()</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00057">nonlinz.cpp:57</a></div></div>
<div class="ttc" id="asection__fwd_8hpp_html_ae27b28b2b4822cecf44b1162406a0a2d"><div class="ttname"><a href="section__fwd_8hpp.html#ae27b28b2b4822cecf44b1162406a0a2d">nlayer</a></div><div class="ttdeci">#define nlayer</div><div class="ttdef"><b>Definition:</b> <a href="section__fwd_8hpp_source.html#l00031">section_fwd.hpp:31</a></div></div>
<div class="ttc" id="aresource_8h_html"><div class="ttname"><a href="resource_8h.html">resource.h</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_html_a9bfac625ccb4b694d85f01e8bb59fcea"><div class="ttname"><a href="class_non_lin_imp.html#a9bfac625ccb4b694d85f01e8bb59fcea">NonLinImp::ratio_amp</a></div><div class="ttdeci">double ratio_amp(int clmploc, int vloc)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00105">nonlinz.cpp:105</a></div></div>
<div class="ttc" id="astruct_nrn_thread_html_a12c49be3278572665cb0ed500c092cc3"><div class="ttname"><a href="struct_nrn_thread.html#a12c49be3278572665cb0ed500c092cc3">NrnThread::tml</a></div><div class="ttdeci">NrnThreadMembList * tml</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00062">multicore.h:62</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_ab8aa82e87e808bc49de4bda5520c048b"><div class="ttname"><a href="class_non_lin_imp_rep.html#ab8aa82e87e808bc49de4bda5520c048b">NonLinImpRep::didv</a></div><div class="ttdeci">void didv()</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00286">nonlinz.cpp:286</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_html_aefd418e97fb6d88a32e86a9d7fed13aa"><div class="ttname"><a href="class_non_lin_imp.html#aefd418e97fb6d88a32e86a9d7fed13aa">NonLinImp::transfer_phase</a></div><div class="ttdeci">double transfer_phase(int curloc, int vloc)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00083">nonlinz.cpp:83</a></div></div>
<div class="ttc" id="anrnunit_8cpp_html_aaac9e27cff8154410a968916b1bf8eca"><div class="ttname"><a href="nrnunit_8cpp.html#aaac9e27cff8154410a968916b1bf8eca">current</a></div><div class="ttdeci">static List * current</div><div class="ttdef"><b>Definition:</b> <a href="nrnunit_8cpp_source.html#l00013">nrnunit.cpp:13</a></div></div>
<div class="ttc" id="anrnoc2iv_8h_html"><div class="ttname"><a href="nrnoc2iv_8h.html">nrnoc2iv.h</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a9672c062385a82b7d8ebf923e9c7e3e3"><div class="ttname"><a href="namespacecoreneuron.html#a9672c062385a82b7d8ebf923e9c7e3e3">coreneuron::structure_change_cnt</a></div><div class="ttdeci">int structure_change_cnt</div><div class="ttdef"><b>Definition:</b> <a href="treeset_8cpp_source.html#l00066">treeset.cpp:66</a></div></div>
<div class="ttc" id="astruct_nrn_thread_memb_list_html_a7422ba69ea8d926f792eee1bf3c8f810"><div class="ttname"><a href="struct_nrn_thread_memb_list.html#a7422ba69ea8d926f792eee1bf3c8f810">NrnThreadMembList::next</a></div><div class="ttdeci">struct NrnThreadMembList * next</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00034">multicore.h:34</a></div></div>
<div class="ttc" id="anonlinz_8cpp_html_a324139c6660ed162e31931d24b772154"><div class="ttname"><a href="nonlinz_8cpp.html#a324139c6660ed162e31931d24b772154">nrndae_extra_eqn_count</a></div><div class="ttdeci">int nrndae_extra_eqn_count()</div><div class="ttdef"><b>Definition:</b> <a href="nrndae_8cpp_source.html#l00026">nrndae.cpp:26</a></div></div>
<div class="ttc" id="astruct_memb__list_html_ac25f612ceb86ee50e8e91cf82e37f328"><div class="ttname"><a href="struct_memb__list.html#ac25f612ceb86ee50e8e91cf82e37f328">Memb_list::prop</a></div><div class="ttdeci">Prop ** prop</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__ml_8h_source.html#l00076">nrnoc_ml.h:76</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a3a9454aa61ff0236e37990f6e83b5a3d"><div class="ttname"><a href="class_non_lin_imp_rep.html#a3a9454aa61ff0236e37990f6e83b5a3d">NonLinImpRep::ode</a></div><div class="ttdeci">void ode(int, Memb_list *)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00533">nonlinz.cpp:533</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a1cb5c0268915f27d2a197e031286581c"><div class="ttname"><a href="class_non_lin_imp_rep.html#a1cb5c0268915f27d2a197e031286581c">NonLinImpRep::deltavec_</a></div><div class="ttdeci">std::vector&lt; double &gt; deltavec_</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00046">nonlinz.cpp:46</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a7b911bd0351fc2d5a141dee8d512f01e"><div class="ttname"><a href="class_non_lin_imp_rep.html#a7b911bd0351fc2d5a141dee8d512f01e">NonLinImpRep::NonLinImpRep</a></div><div class="ttdeci">NonLinImpRep()</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00209">nonlinz.cpp:209</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a004a963731f8a5c295fba256b92c44f1"><div class="ttname"><a href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">coreneuron::nrn_threads</a></div><div class="ttdeci">NrnThread * nrn_threads</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2sim_2multicore_8cpp_source.html#l00056">multicore.cpp:56</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a8bdb06f51bb86a408e5341bb9214c606"><div class="ttname"><a href="class_non_lin_imp_rep.html#a8bdb06f51bb86a408e5341bb9214c606">NonLinImpRep::scnt_</a></div><div class="ttdeci">int scnt_</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00042">nonlinz.cpp:42</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_html_a7c82a03a9b6c3368502abc67534278c7"><div class="ttname"><a href="class_non_lin_imp.html#a7c82a03a9b6c3368502abc67534278c7">NonLinImp::solve</a></div><div class="ttdeci">int solve(int curloc)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00182">nonlinz.cpp:182</a></div></div>
<div class="ttc" id="anrniv_2multisend_8cpp_html_a3691308f2a4c2f6983f2880d32e29c84"><div class="ttname"><a href="nrniv_2multisend_8cpp.html#a3691308f2a4c2f6983f2880d32e29c84">s</a></div><div class="ttdeci">s</div><div class="ttdef"><b>Definition:</b> <a href="nrniv_2multisend_8cpp_source.html#l00521">multisend.cpp:521</a></div></div>
<div class="ttc" id="astruct_nrn_thread_html_a988647ef0f1bd28f61b030de9fce87fb"><div class="ttname"><a href="struct_nrn_thread.html#a988647ef0f1bd28f61b030de9fce87fb">NrnThread::_v_parent</a></div><div class="ttdeci">Node ** _v_parent</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00091">multicore.h:91</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a5064217676c9f83e855ed9883172e3a5"><div class="ttname"><a href="class_non_lin_imp_rep.html#a5064217676c9f83e855ed9883172e3a5">NonLinImpRep::pvdot_</a></div><div class="ttdeci">std::vector&lt; neuron::container::data_handle&lt; double &gt; &gt; pvdot_</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00044">nonlinz.cpp:44</a></div></div>
<div class="ttc" id="astruct_memb__list_html"><div class="ttname"><a href="struct_memb__list.html">Memb_list</a></div><div class="ttdoc">A view into a set of mechanism instances.</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__ml_8h_source.html#l00034">nrnoc_ml.h:34</a></div></div>
<div class="ttc" id="anonlinz_8cpp_html_a3073f24a4cf34a128bcd68f2188bb4e5"><div class="ttname"><a href="nonlinz_8cpp.html#a3073f24a4cf34a128bcd68f2188bb4e5">pargap_jacobi_rhs</a></div><div class="ttdeci">void pargap_jacobi_rhs(std::vector&lt; std::complex&lt; double &gt;&gt; &amp;, const std::vector&lt; std::complex&lt; double &gt;&gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="nrniv_2partrans_8cpp_source.html#l00884">partrans.cpp:884</a></div></div>
<div class="ttc" id="astruct_memb__list_html_adc85ed058419930d59fbef6c88f49557"><div class="ttname"><a href="struct_memb__list.html#adc85ed058419930d59fbef6c88f49557">Memb_list::get_storage_offset</a></div><div class="ttdeci">std::size_t get_storage_offset() const</div><div class="ttdoc">Get the offset of this Memb_list into global storage for this type.</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__ml_8h_source.html#l00195">nrnoc_ml.h:195</a></div></div>
<div class="ttc" id="anonlinz_8h_html"><div class="ttname"><a href="nonlinz_8h.html">nonlinz.h</a></div></div>
<div class="ttc" id="aimpedanc_8cpp_html_a4e8d83261d98e69152dd6e7d586490f2"><div class="ttname"><a href="impedanc_8cpp.html#a4e8d83261d98e69152dd6e7d586490f2">deltafac</a></div><div class="ttdeci">static double deltafac(void *v)</div><div class="ttdef"><b>Definition:</b> <a href="impedanc_8cpp_source.html#l00134">impedanc.cpp:134</a></div></div>
<div class="ttc" id="anrngsl__real__radix2_8cpp_html_abf2d9f657468255c5b9964ea2b6e9e15"><div class="ttname"><a href="nrngsl__real__radix2_8cpp.html#abf2d9f657468255c5b9964ea2b6e9e15">j</a></div><div class="ttdeci">size_t j</div><div class="ttdef"><b>Definition:</b> <a href="nrngsl__real__radix2_8cpp_source.html#l00050">nrngsl_real_radix2.cpp:50</a></div></div>
<div class="ttc" id="anonlinz_8cpp_html_aab22eada665f71f4350df8eb2341e3f6"><div class="ttname"><a href="nonlinz_8cpp.html#aab22eada665f71f4350df8eb2341e3f6">v_setup_vectors</a></div><div class="ttdeci">void v_setup_vectors()</div><div class="ttdef"><b>Definition:</b> <a href="treeset_8cpp_source.html#l01604">treeset.cpp:1604</a></div></div>
<div class="ttc" id="astruct_nrn_thread_html"><div class="ttname"><a href="struct_nrn_thread.html">NrnThread</a></div><div class="ttdoc">Represent main neuron object computed by single thread.</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00058">multicore.h:58</a></div></div>
<div class="ttc" id="astruct_memb__list_html_aecaa9249b834452c28de82fca18fcf7f"><div class="ttname"><a href="struct_memb__list.html#aecaa9249b834452c28de82fca18fcf7f">Memb_list::_thread</a></div><div class="ttdeci">Datum * _thread</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__ml_8h_source.html#l00077">nrnoc_ml.h:77</a></div></div>
<div class="ttc" id="aoccvode_8cpp_html_a87858dcf7e570fd01c1c4a2dc3e676d1"><div class="ttname"><a href="occvode_8cpp.html#a87858dcf7e570fd01c1c4a2dc3e676d1">vsym</a></div><div class="ttdeci">static Symbol * vsym</div><div class="ttdef"><b>Definition:</b> <a href="occvode_8cpp_source.html#l00047">occvode.cpp:47</a></div></div>
<div class="ttc" id="astruct_nrn_thread_html_ad35c5b82ae062b9ec54c45d0ab063fb9"><div class="ttname"><a href="struct_nrn_thread.html#ad35c5b82ae062b9ec54c45d0ab063fb9">NrnThread::_v_node</a></div><div class="ttdeci">Node ** _v_node</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00090">multicore.h:90</a></div></div>
<div class="ttc" id="agroup___n_m_o_d_l_html_ga47a13a7be8b261aee9f063941328e0c2"><div class="ttname"><a href="group___n_m_o_d_l.html#ga47a13a7be8b261aee9f063941328e0c2">buf</a></div><div class="ttdeci">char buf[512]</div><div class="ttdef"><b>Definition:</b> <a href="modlunit_2init_8cpp_source.html#l00013">init.cpp:13</a></div></div>
<div class="ttc" id="astruct_nrn_thread_memb_list_html"><div class="ttname"><a href="struct_nrn_thread_memb_list.html">NrnThreadMembList</a></div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00033">multicore.h:33</a></div></div>
<div class="ttc" id="amembfunc_8hpp_html_a3aa216f6d9b942391fc15090d23256e5"><div class="ttname"><a href="membfunc_8hpp.html#a3aa216f6d9b942391fc15090d23256e5">CAP</a></div><div class="ttdeci">#define CAP</div><div class="ttdef"><b>Definition:</b> <a href="membfunc_8hpp_source.html#l00060">membfunc.hpp:60</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_html_a313b42ad2230d3456d1f8d32bcba454b"><div class="ttname"><a href="class_non_lin_imp.html#a313b42ad2230d3456d1f8d32bcba454b">NonLinImp::transfer_amp</a></div><div class="ttdeci">double transfer_amp(int curloc, int vloc)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00061">nonlinz.cpp:61</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a1f645ec1a7a94fc06b59a659cf9bf5c6"><div class="ttname"><a href="class_non_lin_imp_rep.html#a1f645ec1a7a94fc06b59a659cf9bf5c6">NonLinImpRep::neq_v_</a></div><div class="ttdeci">int neq_v_</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00043">nonlinz.cpp:43</a></div></div>
<div class="ttc" id="astruct_memb__list_html_a852e0e3ee6ca9dd4f1e467710f2fc79d"><div class="ttname"><a href="struct_memb__list.html#a852e0e3ee6ca9dd4f1e467710f2fc79d">Memb_list::nodeindices</a></div><div class="ttdeci">int * nodeindices</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__ml_8h_source.html#l00074">nrnoc_ml.h:74</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_ad71f9084037f0c08e258397c7397f6b3"><div class="ttname"><a href="class_non_lin_imp_rep.html#ad71f9084037f0c08e258397c7397f6b3">NonLinImpRep::dsds</a></div><div class="ttdeci">void dsds()</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00456">nonlinz.cpp:456</a></div></div>
<div class="ttc" id="anonlinz_8cpp_html_a19687b91a47188d7593f5dbdbc8121ca"><div class="ttname"><a href="nonlinz_8cpp.html#a19687b91a47188d7593f5dbdbc8121ca">nrnthread_v_transfer_</a></div><div class="ttdeci">void(* nrnthread_v_transfer_)(NrnThread *)</div><div class="ttdef"><b>Definition:</b> <a href="fadvance_8cpp_source.html#l00139">fadvance.cpp:139</a></div></div>
<div class="ttc" id="astruct_nrn_thread_html_ab08e4e11b4ae9ffd80ea6c043799d161"><div class="ttname"><a href="struct_nrn_thread.html#ab08e4e11b4ae9ffd80ea6c043799d161">NrnThread::_ecell_memb_list</a></div><div class="ttdeci">Memb_list * _ecell_memb_list</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00095">multicore.h:95</a></div></div>
<div class="ttc" id="asection__fwd_8hpp_html_a3869585ebb22ff27e47c12e0bc58495b"><div class="ttname"><a href="section__fwd_8hpp.html#a3869585ebb22ff27e47c12e0bc58495b">NODEB</a></div><div class="ttdeci">#define NODEB(n)</div><div class="ttdef"><b>Definition:</b> <a href="section__fwd_8hpp_source.html#l00053">section_fwd.hpp:53</a></div></div>
<div class="ttc" id="anonlin_8cpp_html_ab8184ad1f6ab2dd04296c449c4362911"><div class="ttname"><a href="nonlin_8cpp.html#ab8184ad1f6ab2dd04296c449c4362911">solve</a></div><div class="ttdeci">void solve(void)</div><div class="ttdef"><b>Definition:</b> <a href="nonlin_8cpp_source.html#l00254">nonlin.cpp:254</a></div></div>
<div class="ttc" id="akschan_8cpp_html_a3d3719d861f76a07579ae9f2ca08c37a"><div class="ttname"><a href="kschan_8cpp.html#a3d3719d861f76a07579ae9f2ca08c37a">ode_count</a></div><div class="ttdeci">static int ode_count(int type)</div><div class="ttdef"><b>Definition:</b> <a href="kschan_8cpp_source.html#l00092">kschan.cpp:92</a></div></div>
<div class="ttc" id="astruct_node_html_a8272596a06a5a4b8fa932a0f7e7652ba"><div class="ttname"><a href="struct_node.html#a8272596a06a5a4b8fa932a0f7e7652ba">Node::v_node_index</a></div><div class="ttdeci">int v_node_index</div><div class="ttdef"><b>Definition:</b> <a href="section_8h_source.html#l00211">section.h:211</a></div></div>
<div class="ttc" id="astruct_memb__list_html_a63d35b7d3b33bfd018c88a2484900e42"><div class="ttname"><a href="struct_memb__list.html#a63d35b7d3b33bfd018c88a2484900e42">Memb_list::nodecount</a></div><div class="ttdeci">int nodecount</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__ml_8h_source.html#l00078">nrnoc_ml.h:78</a></div></div>
<div class="ttc" id="astruct_memb__list_html_ab81001865b26eafcbfae9185fc94b750"><div class="ttname"><a href="struct_memb__list.html#ab81001865b26eafcbfae9185fc94b750">Memb_list::data</a></div><div class="ttdeci">std::vector&lt; double * &gt; data()</div><div class="ttdoc">Get a vector of double* representing the model data.</div><div class="ttdef"><b>Definition:</b> <a href="memblist_8cpp_source.html#l00064">memblist.cpp:64</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a9ab04115b4929b79b0987a668e43b2fa"><div class="ttname"><a href="class_non_lin_imp_rep.html#a9ab04115b4929b79b0987a668e43b2fa">NonLinImpRep::dsdv</a></div><div class="ttdeci">void dsdv()</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00398">nonlinz.cpp:398</a></div></div>
<div class="ttc" id="astruct_nrn_thread_html_a2196aa5851071e6e2aefd1ff08e79cd3"><div class="ttname"><a href="struct_nrn_thread.html#a2196aa5851071e6e2aefd1ff08e79cd3">NrnThread::ncell</a></div><div class="ttdeci">int ncell</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8h_source.html#l00064">multicore.h:64</a></div></div>
<div class="ttc" id="anrngsl_8h_html_ac8a7d09f1236d5375c09b52b83a26add"><div class="ttname"><a href="nrngsl_8h.html#ac8a7d09f1236d5375c09b52b83a26add">n</a></div><div class="ttdeci">int const size_t const size_t n</div><div class="ttdef"><b>Definition:</b> <a href="nrngsl_8h_source.html#l00010">nrngsl.h:10</a></div></div>
<div class="ttc" id="astruct_symbol_html"><div class="ttname"><a href="struct_symbol.html">Symbol</a></div><div class="ttdef"><b>Definition:</b> <a href="model_8h_source.html#l00047">model.h:47</a></div></div>
<div class="ttc" id="astruct_memb__list_html_a8f722348b9ee18e8cd45195d82990d2d"><div class="ttname"><a href="struct_memb__list.html#a8f722348b9ee18e8cd45195d82990d2d">Memb_list::nodelist</a></div><div class="ttdeci">Node ** nodelist</div><div class="ttdef"><b>Definition:</b> <a href="nrnoc__ml_8h_source.html#l00068">nrnoc_ml.h:68</a></div></div>
<div class="ttc" id="anrn__ansi_8h_html_af4cd27306dce6814958b7c50a8a3e248"><div class="ttname"><a href="nrn__ansi_8h.html#af4cd27306dce6814958b7c50a8a3e248">nrn_ensure_model_data_are_sorted</a></div><div class="ttdeci">neuron::model_sorted_token nrn_ensure_model_data_are_sorted()</div><div class="ttdoc">Ensure neuron::container::* data are sorted.</div><div class="ttdef"><b>Definition:</b> <a href="treeset_8cpp_source.html#l02303">treeset.cpp:2303</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_ab4eb16aba47d7f831922a8d02ae99dac"><div class="ttname"><a href="class_non_lin_imp_rep.html#ab4eb16aba47d7f831922a8d02ae99dac">NonLinImpRep::gapsolve</a></div><div class="ttdeci">int gapsolve()</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00539">nonlinz.cpp:539</a></div></div>
<div class="ttc" id="asection__fwd_8hpp_html_ac6b7b6bd569a0716f85198f9fc6017d0"><div class="ttname"><a href="section__fwd_8hpp.html#ac6b7b6bd569a0716f85198f9fc6017d0">NODERHS</a></div><div class="ttdeci">#define NODERHS(n)</div><div class="ttdef"><b>Definition:</b> <a href="section__fwd_8hpp_source.html#l00055">section_fwd.hpp:55</a></div></div>
<div class="ttc" id="aclass_non_lin_imp_rep_html_a36176333bb6fc9b66b85b55c46233048"><div class="ttname"><a href="class_non_lin_imp_rep.html#a36176333bb6fc9b66b85b55c46233048">NonLinImpRep::v_</a></div><div class="ttdeci">std::vector&lt; std::complex&lt; double &gt; &gt; v_</div><div class="ttdef"><b>Definition:</b> <a href="nonlinz_8cpp_source.html#l00045">nonlinz.cpp:45</a></div></div>
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_3839636f4dffaa4aab0a620bf9b8685f.html">nrniv</a></li><li class="navelem"><a class="el" href="nonlinz_8cpp.html">nonlinz.cpp</a></li>
  </ul>
</div>
<hr class="footer"/>
<address class="footer">
    <small>
    </small>
</address>
<!--END !GENERATE_TREEVIEW-->
</body>
</html>
