<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LinearMechanism &mdash; NEURON  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=87e54e7c" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=6933245a" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Point Processes and Artificial Cells" href="mechanisms/mech.html" />
    <link rel="prev" title="KSChan" href="kschan.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            NEURON
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Building:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cmake_doc/index.html">CMake Build Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/developer.html">Developer Builds</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../videos/index.html">Training videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../courses/exercises2018.html">NEURON Course Exercises</a></li>
<li class="toctree-l1"><a class="reference external" href="https://neuron.yale.edu/phpBB">The NEURON forum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications about NEURON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications-using-neuron.html">Publications using NEURON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NEURON scripting:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../scripting.html">Running Python and HOC scripts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">NEURON Python documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#quick-links">Quick Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#basic-programming">Basic Programming</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#model-specification">Model Specification</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../guitools.html">Model Specification GUI Tools</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../programmatic.html">Programmatic Model Specification</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="topology.html">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="ions.html">Ions</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="mechanisms.html">Dynamics (Channels, etc…)</a></li>
<li class="toctree-l4"><a class="reference internal" href="rxd.html">Basic Reaction-Diffusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="network.html">Networks</a></li>
<li class="toctree-l4"><a class="reference internal" href="electrod.html">Electrode</a></li>
<li class="toctree-l4"><a class="reference internal" href="mechtype.html">MechanismType</a></li>
<li class="toctree-l4"><a class="reference internal" href="ste.html">StateTransitionEvent</a></li>
<li class="toctree-l4"><a class="reference internal" href="obsoletestimuli.html">Obsolete Stimuli</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#simulation-control">Simulation Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#visualization">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#analysis">Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../hoc/index.html">NEURON HOC documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../otherscripting.html">Other scripting languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Python tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rxd-tutorials/index.html">Python RXD tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../coreneuron/index.html">CoreNEURON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NMODLanguage:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nmodl/index.html">NMODLanguage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../scm/index.html">NEURON SCM and Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/index.html">NEURON Development topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doxygen.html">C/C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Removed Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../removed_features.html">Removed Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changelog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">NEURON 8.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#neuron-8-1">NEURON 8.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#neuron-8-0">NEURON 8.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#feedback-help">Feedback / Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NEURON</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">NEURON Python documentation</a></li>
          <li class="breadcrumb-item"><a href="../programmatic.html">Programmatic Model Specification</a></li>
          <li class="breadcrumb-item"><a href="mechanisms.html">Dynamics (Channels, etc…)</a></li>
      <li class="breadcrumb-item active">LinearMechanism</li>
<li class="wy-breadcrumbs-aside">
    
    
        
        <a href="../../../..html/../hoc/modelspec/programmatic/linmod.html" >  Switch to HOC</a>
    
</li>

      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/python/modelspec/programmatic/linmod.rst.txt" rel="nofollow"> View page source</a>
      </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><dl class="docutils"><dt><a href="#LinearMechanism" title="Link to this definition">LinearMechanism</a></dt><dd></dd></dl></p><section id="linearmechanism">
<span id="linmod"></span><h1>LinearMechanism<a class="headerlink" href="#linearmechanism" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="LinearMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinearMechanism</span></span><a class="headerlink" href="#LinearMechanism" title="Link to this definition"></a></dt>
<dd><dl>
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">lm</span> <span class="pre">=</span> <span class="pre">h.LinearMechanism(c,</span> <span class="pre">g,</span> <span class="pre">y,</span> <span class="pre">[y0],</span> <span class="pre">b)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">lm</span> <span class="pre">=</span> <span class="pre">h.LinearMechanism(c,</span> <span class="pre">g,</span> <span class="pre">y,</span> <span class="pre">[y0],</span> <span class="pre">b,</span> <span class="pre">x,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">lm</span> <span class="pre">=</span> <span class="pre">h.LinearMechanism(c,</span> <span class="pre">g,</span> <span class="pre">y,</span> <span class="pre">[y0],</span> <span class="pre">b,</span> <span class="pre">sl,</span> <span class="pre">xvec,</span> <span class="pre">[layervec])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">lm</span> <span class="pre">=</span> <span class="pre">h.LinearMechanism(pycallable,</span> <span class="pre">c,</span> <span class="pre">g,</span> <span class="pre">y,</span> <span class="pre">...)</span></code></p>
</dd>
<dt>Description:</dt><dd><p>Adds linear equations to the tree matrix current balance equations.
I.e. the equations are solved
simultaneously with the current balance equations.
These equations may modify current balance equations and involve
membrane potentials as dependent variables.</p>
<p>The equations added are of the differential-algebraic form
<span class="math notranslate nohighlight">\(c \frac{dy}{dt} + g y = b\)</span>
with initial conditions specified by the optional y0 vector argument.
c and g must be square matrices of the same rank as the y and b vectors.
The implementation is more efficient if c is a sparse matrix since
at every time step c*y/dt must be computed.</p>
<p>When a LinearMechanism is created, all the potentially non-zero elements
for the c and g matrices must be actually non-zero so that
the mathematical topology of the matrices is known in advance.
After creation, elements can be set to 0 if desired.</p>
<p>The arguments after the b vector specify which voltages and current
balance equations are coupled to this system. The scalar form, x, with
the specified <cite>section</cite> means that the first equation
is added to the current balance equation at this location and the first
dependent variable is a copy of the membrane potential. If the
system is coupled to more than one location, then  sl must be a SectionList
and xvec a Vector of relative positions (0 … 1) specifying the
locations. In this case, the first xvec.size equations are added to the
corresponding current balance equations and the first xvec.size dependent
y variables are copies of the membrane potentials at this location.
If the optional layervec argument is present then the values must be
0, 1, or 2 (or up to however many layers are defined in <code class="file docutils literal notranslate"><span class="pre">src/nrnoc/options.h</span></code>)
0 refers to the internal potential (equal to the membrane potential when
the extracellular mechanism is not inserted), and higher numbers refer
to the <code class="docutils literal notranslate"><span class="pre">vext[layer-1]</span></code> layer (or ground if the extracellular mechanism is
not inserted).</p>
<p>If some y variables correspond to membrane potential, the corresponding
initial values in the y0 vector are ignored and the initial values come
from the values of v during the normal <a class="reference internal" href="../../simctrl/programmatic.html#finitialize" title="finitialize"><code class="xref py py-func docutils literal notranslate"><span class="pre">finitialize()</span></code></a> call. If you change
the value of v after finitialize, then you should also change the
corresponding y values if the linear system involves derivatives of v.</p>
<p>Note that current balance equations of sections when 0 &lt; x &lt; 1 have dimensions
of milliamp/cm2 and positive terms are outward. Thus
c elements involving voltages in mV
have dimensions of 1000 <span class="math notranslate nohighlight">\(\mathrm{\mu{}F/cm^2}\)</span> (so a value of .001 corresponds to
1  <span class="math notranslate nohighlight">\(\mathrm{\mu{}F/cm^2}\)</span>), g elements have dimensions of <span class="math notranslate nohighlight">\(\mathrm{S/cm^2}\)</span>, and b elements have
dimensions of outward current in <span class="math notranslate nohighlight">\(\mathrm{milliamp/cm^2}\)</span>. The current balance
equations for the zero area nodes at the beginning and end
of a section (x = 0 and x = 1) have terms with the dimensions of
nanoamps. Thus c elements involving voltages in mV have dimensions
of nF and g elements have dimensions of <span class="math notranslate nohighlight">\(\mathrm{\mu{}S}\)</span>.</p>
<p>The existence of one or more LinearMechanism switches the gaussian elimination
solver to the general sparse linear equation solver written by
Kenneth S. Kundert and available from
<a class="reference external" href="http://www.netlib.org/sparse/index.html">http://www.netlib.org/sparse/index.html</a>
Although, even with no added equations, the solving of m*x=b takes more
than twice as long as the original default solver, there is no restriction
to a tree topology.</p>
</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span>

<span class="n">tstop</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">soma</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;soma&quot;</span><span class="p">)</span>
<span class="n">soma</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hh</span><span class="p">)</span>

<span class="c1"># ideal voltage clamp.</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># sparse - no elements used</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># y[1] is injected current</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>      <span class="c1"># b[1] is voltage clamp level</span>
<span class="n">g</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">LinearMechanism</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="n">soma</span><span class="p">)</span>

<span class="n">h</span><span class="o">.</span><span class="n">finitialize</span><span class="p">(</span><span class="o">-</span><span class="mi">65</span><span class="p">)</span>
<span class="k">while</span> <span class="n">h</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">tstop</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t=</span><span class="si">%-8g</span><span class="s1"> v=</span><span class="si">%-8g</span><span class="s1"> y[1]=</span><span class="si">%-8g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">soma</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">h</span><span class="o">.</span><span class="n">fadvance</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Does not work with the CVODE integrator but does work with the
differential-algebraic solver IDA. Note that if the standard
run system is loaded, <code class="docutils literal notranslate"><span class="pre">h.cvode_active(True)</span></code> will automatically
choose the correct variable step integrator.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<blockquote>
<div><p>Does not allow changes to coupling locations.</p>
</div></blockquote>
<p>Is not notified when matrices, vectors, or segments it depends on
disappear.</p>
</div>
<dl class="simple">
<dt>Description (continued):</dt><dd><p>If the pycallable argument (A Python Callable object) is present
it is called just before the b Vector is used during a simulation. The
callable can change the elements of b and g (but do not introduce new
elements into g) as a function of time and states. It may be useful for
stability and performance to place the linearized part of b into g.
Consider the following pendulum.py with equations</p>
</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\frac{d\theta}{dt} = \omega\]</div>
<div class="math notranslate nohighlight">
\[\frac{d\omega}{dt} = -\frac{g}{L} \sin(\theta) \text{ with } \frac{g}{L}=1\]</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">gui</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span>

<span class="n">cmat</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ident</span><span class="p">()</span>

<span class="n">gmat</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">gmat</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">callback</span><span class="p">():</span>
  <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">nlm</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">LinearMechanism</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">cmat</span><span class="p">,</span> <span class="n">gmat</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="n">dummy</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;dummy&quot;</span><span class="p">)</span>
<span class="n">trajec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">_ref_x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">tvec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">()</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">_ref_t</span><span class="p">)</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="n">h</span><span class="o">.</span><span class="n">tstop</span><span class="o">=</span><span class="mi">50</span>

<span class="k">def</span> <span class="nf">prun</span><span class="p">(</span><span class="n">theta0</span><span class="p">,</span> <span class="n">omega0</span><span class="p">):</span>
  <span class="n">graph</span><span class="o">.</span><span class="n">erase</span><span class="p">()</span>
  <span class="n">y0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta0</span>
  <span class="n">y0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">omega0</span>
  <span class="n">h</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
  <span class="n">trajec</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">tvec</span><span class="p">)</span>

<span class="n">h</span><span class="o">.</span><span class="n">dt</span> <span class="o">/=</span> <span class="mi">10</span>
<span class="n">h</span><span class="o">.</span><span class="n">cvode</span><span class="o">.</span><span class="n">atol</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">cvode_active</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">prun</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.9999</span><span class="p">)</span> <span class="c1"># 2.0001 will keep it rotating</span>
<span class="n">graph</span><span class="o">.</span><span class="n">exec_menu</span><span class="p">(</span><span class="s2">&quot;View = plot&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/linmod.png" class="align-center" src="../../../_images/linmod.png" />
</div></blockquote>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="kschan.html" class="btn btn-neutral float-left" title="KSChan" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mechanisms/mech.html" class="btn btn-neutral float-right" title="Point Processes and Artificial Cells" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Duke, Yale and the Blue Brain Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>